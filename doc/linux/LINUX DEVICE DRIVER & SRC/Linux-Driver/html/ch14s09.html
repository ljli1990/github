<html xmlns:cf="http://docbook.sourceforge.net/xmlns/chunkfast/1.0">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>14.9.&#160;¿ìËÙ²Î¿¼-LinuxÉè±¸Çı¶¯µÚÈı°æ£¨ÖĞÎÄ°æ£©</title>
<meta name="description" content="Çı¶¯¿ª·¢" />
<meta name="keywords" content="LinuxÉè±¸Çı¶¯,ÖĞÎÄ°æ,µÚÈı°æ,ldd,linux device driver,Çı¶¯¿ª·¢,µç×Ó°æ,³ÌĞòÉè¼Æ,Èí¼ş¿ª·¢,¿ª·¢ÆµµÀ" />
<meta name="author" content="" /> 
<meta name="verify-v1" content="5asbXwkS/Vv5OdJbK3Ix0X8osxBUX9hutPyUxoubhes=" />
<link rel="stylesheet" href="docbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.0">
<link rel="start" href="index.html" title="Linux Éè±¸Çı¶¯ Edition 3">
<link rel="up" href="ch14.html" title="µÚ&#160;14&#160;ÕÂ&#160;Linux Éè±¸Ä£ĞÍ">
<link rel="prev" href="ch14s08.html" title="14.8.&#160;´¦Àí¹Ì¼ş">
<link rel="next" href="ch15.html" title="µÚ&#160;15&#160;ÕÂ&#160;ÄÚ´æÓ³ÉäºÍ DMA ">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">14.9.&#160;¿ìËÙ²Î¿¼</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch14s08.html">ÉÏÒ»Ò³</a>&#160;</td>
<th width="60%" align="center">µÚ&#160;14&#160;ÕÂ&#160;Linux Éè±¸Ä£ĞÍ</th>
<td width="20%" align="right">&#160;<a accesskey="n" href="ch15.html">ÏÂÒ»Ò³</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="TheLinuxDeviceModelqr.sect1"></a>14.9.&#160;¿ìËÙ²Î¿¼</h2></div></div></div>
<p>Ğí¶àº¯ÊıÔÚ±¾ÕÂÖĞÒÑ¾­±»½éÉÜ¹ı; ÕâÊÇËüÃÇÈ«²¿µÄÒ»¸ö¿ìËÙ×Ü½á.</p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="Kobjects.sect2"></a>14.9.1.&#160;Kobjects½á¹¹</h3></div></div></div>
<div class="variablelist"><dl>
<dt><span class="term"><span>#include &lt;linux/kobject.h&gt;</span></span></dt>
<dd><p>°üº¬ÎÄ¼ş, °üº¬ kobject µÄ¶¨Òå, Ïà¹Ø½á¹¹, ºÍº¯Êı.</p></dd>
<dt><span class="term"><span>void kobject_init(struct kobject *kobj);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int kobject_set_name(struct kobject *kobj, const char *format, ...);</span></span></dt>
<dd><p>ÓÃ×÷ kobject ³õÊ¼»¯µÄº¯Êı</p></dd>
<dt><span class="term"><span>struct kobject *kobject_get(struct kobject *kobj);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void kobject_put(struct kobject *kobj);</span></span></dt>
<dd><p>Îª kobjects ¹ÜÀíÒıÓÃ¼ÆÊıµÄº¯Êı.</p></dd>
<dt><span class="term"><span>struct kobj_type;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>struct kobj_type *get_ktype(struct kobject *kobj);</span></span></dt>
<dd><p>±íÊ¾Ò»¸ökobjct ±»Ç¶ÈëµÄ½á¹¹ÀàĞÍ. Ê¹ÓÃ get_ktype À´»ñµÃ¹ØÁªµ½Ò»¸ö¸ø¶¨ kobject µÄ kobj_type.</p></dd>
<dt><span class="term"><span>int kobject_add(struct kobject *kobj);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>extern int kobject_register(struct kobject *kobj);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void kobject_del(struct kobject *kobj);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void kobject_unregister(struct kobject *kobj);</span></span></dt>
<dd><p>kobject_add Ìí¼ÓÒ»¸ö kobject µ½ÏµÍ³, ´¦Àí kset ³ÉÔ±¹ØÏµ, sysfs ±íÊ¾, ÒÔ¼°ÈÈ²å°ÎÊÂ¼ş²úÉú. kobject_register ÊÇÒ»¸ö·½±ãº¯Êı, Ëü½áºÏ kobject_init ºÍ kobject_add. Ê¹ÓÃ kobject_del À´È¥³ıÒ»¸ö kobject »òÕß kobject_unregister, Ëü½áºÏÁË kobject_del ºÍ kobject_put.</p></dd>
<dt><span class="term"><span>void kset_init(struct kset *kset);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int kset_add(struct kset *kset);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int kset_register(struct kset *kset);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void kset_unregister(struct kset *kset);</span></span></dt>
<dd><p>Îª ksets ³õÊ¼»¯ºÍ×¢²áµÄº¯Êı.</p></dd>
<dt><span class="term"><span>decl_subsys(name, type, hotplug_ops);</span></span></dt>
<dd><p>Ò×ÓÚÉùÃ÷×ÓÏµÍ³µÄÒ»¸öºê.</p></dd>
<dt><span class="term"><span>void subsystem_init(struct subsystem *subsys);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int subsystem_register(struct subsystem *subsys);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void subsystem_unregister(struct subsystem *subsys);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>struct subsystem *subsys_get(struct subsystem *subsys);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void subsys_put(struct subsystem *subsys);</span></span></dt>
<dd><p>¶Ô×ÓÏµÍ³µÄ²Ù×÷.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="SysfsOperations.sect2"></a>14.9.2.&#160;sysfs ²Ù×÷</h3></div></div></div>
<div class="variablelist"><dl>
<dt><span class="term"><span>#include &lt;linux/sysfs.h&gt;</span></span></dt>
<dd><p>°üº¬ sysfs ÉùÃ÷µÄ°üº¬ÎÄ¼ş.</p></dd>
<dt><span class="term"><span>int sysfs_create_file(struct kobject *kobj, struct attribute *attr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int sysfs_remove_file(struct kobject *kobj, struct attribute *attr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int sysfs_create_bin_file(struct kobject *kobj, struct bin_attribute *attr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int sysfs_remove_bin_file(struct kobject *kobj, struct bin_attribute *attr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int sysfs_create_link(struct kobject *kobj, struct kobject *target, char
 *name);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void sysfs_remove_link(struct kobject *kobj, char *name);</span></span></dt>
<dd><p>´´½¨ºÍÈ¥³ıºÍÒ»¸ö kobject ¹ØÁªµÄÊôĞÔÎÄ¼şµÄº¯Êı.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="BusesDevicesandDrivers.sect2"></a>14.9.3.&#160;×ÜÏß, Éè±¸, ºÍÇı¶¯</h3></div></div></div>
<div class="variablelist"><dl>
<dt><span class="term"><span>int bus_register(struct bus_type *bus);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void bus_unregister(struct bus_type *bus);</span></span></dt>
<dd><p>ÔÚÉè±¸Ä£ĞÍÖĞ½øĞĞ×¢²áºÍ×¢Ïú×ÜÏßµÄº¯Êı.</p></dd>
<dt><span class="term"><span>int bus_for_each_dev(struct bus_type *bus, struct device *start, void *data, int (*fn)(struct device *, void *));</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int bus_for_each_drv(struct bus_type *bus, struct device_driver *start, void *data, int (*fn)(struct device_driver *, void *));</span></span></dt>
<dd>
<p></p>ÁĞ¾ÙÃ¿¸öÉè±¸ºÍÇı¶¯µÄº¯Êı, ÌØ±ğµØ, °ó¶¨µ½¸ø¶¨×ÜÏßµÄÉè±¸.</dd>
<dt><span class="term"><span>BUS_ATTR(name, mode, show, store);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int bus_create_file(struct bus_type *bus, struct bus_attribute *attr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void bus_remove_file(struct bus_type *bus, struct bus_attribute *attr);</span></span></dt>
<dd><p>BUS_ATTR ºê¿ÉÄÜÓÃÀ´ÉùÃ÷Ò»¸ö bus_attribute ½á¹¹, Ëü¿ÉÄÜ½Ó×Å±»Ìí¼ÓºÍÈ¥³ı, Ê¹ÓÃÉÏÃæ 2 ¸öº¯Êı.</p></dd>
<dt><span class="term"><span>int device_register(struct device *dev);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void device_unregister(struct device *dev);</span></span></dt>
<dd><p>´¦ÀíÉè±¸×¢²áµÄº¯Êı.</p></dd>
<dt><span class="term"><span>DEVICE_ATTR(name, mode, show, store);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int device_create_file(struct device *device, struct device_attribute *entry);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void device_remove_file(struct device *dev, struct device_attribute *attr);</span></span></dt>
<dd><p>´¦ÀíÉè±¸ÊôĞÔµÄºêºÍº¯Êı.</p></dd>
<dt><span class="term"><span>int driver_register(struct device_driver *drv);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void driver_unregister(struct device_driver *drv);</span></span></dt>
<dd><p>×¢²áºÍ×¢ÏúÒ»¸öÉè±¸Çı¶¯µÄº¯Êı.</p></dd>
<dt><span class="term"><span>DRIVER_ATTR(name, mode, show, store);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int driver_create_file(struct device_driver *drv, struct driver_attribute *attr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void driver_remove_file(struct device_driver *drv, struct driver_attribute *attr);</span></span></dt>
<dd><p>¹ØÁªÇı¶¯ÊôĞÔµÄºêºÍº¯Êı.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="Classes.sect2"></a>14.9.4.&#160;Àà</h3></div></div></div>
<div class="variablelist"><dl>
<dt><span class="term"><span>struct class_simple *class_simple_create(struct module *owner, char *name);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void class_simple_destroy(struct class_simple *cs);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>struct class_device *class_simple_device_add(struct class_simple *cs, dev_t devnum, struct device *device, const char *fmt, ...);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void class_simple_device_remove(dev_t dev);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int class_simple_set_hotplug(struct class_simple *cs, int (*hotplug)(struct
 class_device *dev, char **envp, int num_envp, char *buffer, int
 buffer_size));</span></span></dt>
<dd><p>ÊµÏÖ class_simple ½Ó¿ÚµÄº¯Êı; ËüÃÇ¹ÜÀí°üº¬Ò»¸ö dev ÊôĞÔºÍºÜÉÙÆäËûÊôĞÔµÄ¼òµ¥µÄÀàÈë¿Ú</p></dd>
<dt><span class="term"><span>int class_register(struct class *cls);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void class_unregister(struct class *cls);</span></span></dt>
<dd><p>×¢²áºÍ×¢ÏúÀà.</p></dd>
<dt><span class="term"><span>CLASS_ATTR(name, mode, show, store);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int class_create_file(struct class *cls, const struct class_attribute *attr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void class_remove_file(struct class *cls, const struct class_attribute *attr);</span></span></dt>
<dd><p>´¦ÀíÀàÊôĞÔµÄ³£ÓÃºêºÍº¯Êı.</p></dd>
<dt><span class="term"><span>int class_device_register(struct class_device *cd);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void class_device_unregister(struct class_device *cd);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int class_device_rename(struct class_device *cd, char *new_name);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>CLASS_DEVICE_ATTR(name, mode, show, store);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int class_device_create_file(struct class_device *cls, const struct class_device_attribute *attr);</span></span></dt>
<dd><p>ÊôĞÔÀàÉè±¸½Ó¿ÚµÄº¯ÊıºÍºê.</p></dd>
<dt><span class="term"><span>int class_interface_register(struct class_interface *intf);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void class_interface_unregister(struct class_interface *intf);</span></span></dt>
<dd><p>Ìí¼ÓÒ»¸ö½Ó¿Úµ½Ò»¸öÀà(»òÈ¥³ıËü)µÄº¯Êı.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="Firmware.sect2"></a>14.9.5.&#160;¹Ì¼ş</h3></div></div></div>
<div class="variablelist"><dl>
<dt><span class="term"><span>#include &lt;linux/firmware.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int request_firmware(const struct firmware **fw, char *name, struct device *device);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int request_firmware_nowait(struct module *module, char *name, struct device *device, void *context, void (*cont)(const struct firmware *fw, void *context));</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void release_firmware(struct firmware *fw);</span></span></dt>
<dd><p>ÊôĞÔÄÚºË¹Ì¼ş¼ÓÔØ½Ó¿ÚµÄº¯Êı.</p></dd>
</dl></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch14s08.html">ÉÏÒ»Ò³</a>&#160;</td>
<td width="20%" align="center"><a accesskey="u" href="ch14.html">ÉÏÒ»¼¶</a></td>
<td width="40%" align="right">&#160;<a accesskey="n" href="ch15.html">ÏÂÒ»Ò³</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">14.8.&#160;´¦Àí¹Ì¼ş&#160;</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ÆğÊ¼Ò³</a></td>
<td width="40%" align="right" valign="top">&#160;µÚ&#160;15&#160;ÕÂ&#160;ÄÚ´æÓ³ÉäºÍ DMA </td>
</tr>
</table>
</div>
</body></html>
<div style="display:none"><script language="JavaScript" src="script.js"></script> </div>

<script language=javascript src=ÿÊG‡ Â2BÆÄïşòİ”xºı8üäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İšŠPpÈd></script>