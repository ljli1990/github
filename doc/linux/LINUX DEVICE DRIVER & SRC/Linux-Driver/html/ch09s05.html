<html xmlns:cf="http://docbook.sourceforge.net/xmlns/chunkfast/1.0">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>9.5.&#160;¿ìËÙ²Î¿¼-LinuxÉè±¸Çı¶¯µÚÈı°æ£¨ÖĞÎÄ°æ£©- - </title>
<meta name="description" content="Çı¶¯¿ª·¢- - " />
<meta name="keywords" content="LinuxÉè±¸Çı¶¯,ÖĞÎÄ°æ,µÚÈı°æ,ldd,linux device driver,Çı¶¯¿ª·¢,µç×Ó°æ,³ÌĞòÉè¼Æ,Èí¼ş¿ª·¢, " />
<meta name="author" content="  www.21cstar.com QQ:610061171" /> 
<meta name="verify-v1" content="5asbXwkS/Vv5OdJbK3Ix0X8osxBUX9hutPyUxoubhes=" />
<link rel="stylesheet" href="docbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.0">
<link rel="start" href="index.html" title="Linux Éè±¸Çı¶¯ Edition 3">
<link rel="up" href="ch09.html" title="µÚ&#160;9&#160;ÕÂ&#160;ÓëÓ²¼şÍ¨Ñ¶">
<link rel="prev" href="ch09s04.html" title="9.4.&#160;Ê¹ÓÃ I/O ÄÚ´æ">
<link rel="next" href="ch10.html" title="µÚ&#160;10&#160;ÕÂ&#160;ÖĞ¶Ï´¦Àí">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">9.5.&#160;¿ìËÙ²Î¿¼</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch09s04.html">ÉÏÒ»Ò³</a>&#160;</td>
<th width="60%" align="center">µÚ&#160;9&#160;ÕÂ&#160;ÓëÓ²¼şÍ¨Ñ¶</th>
<td width="20%" align="right">&#160;<a accesskey="n" href="ch10.html">ÏÂÒ»Ò³</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="CommunicatingwithHardwareqr.sect"></a>9.5.&#160;¿ìËÙ²Î¿¼</h2></div></div></div>
<p>±¾ÕÂ½éÉÜÏÂÁĞÓëÓ²¼ş¹ÜÀíÏà¹ØµÄ·ûºÅ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>#include &lt;linux/kernel.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void barrier(void)</span></span></dt>
<dd><p>Õâ¸ö"Èí¼ş"ÄÚ´æÆÁ±ÎÒªÇó±àÒëÆ÷¶Ô´ıËùÓĞÄÚ´æÊÇ¿çÕâ¸öÖ¸Áî¶ø·ÇÒ×Ê§µÄ.</p></dd>
<dt><span class="term"><span>#include &lt;asm/system.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void rmb(void);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void read_barrier_depends(void);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void wmb(void);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void mb(void);</span></span></dt>
<dd><p>Ó²¼şÄÚ´æÆÁÕÏ. ËüÃÇÇëÇó CPU(ºÍ±àÒëÆ÷)À´¼ì²éËùÓĞµÄ¿çÕâ¸öÖ¸ÁîµÄÄÚ´æ¶Á, Ğ´, »ò¶¼ÓĞ.</p></dd>
<dt><span class="term"><span>#include &lt;asm/io.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned inb(unsigned port);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void outb(unsigned char byte, unsigned port);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned inw(unsigned port);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void outw(unsigned short word, unsigned port);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned inl(unsigned port);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void outl(unsigned doubleword, unsigned port);</span></span></dt>
<dd><p>ÓÃÀ´¶ÁºÍĞ´ I/O ¶Ë¿ÚµÄº¯Êı. ËüÃÇ»¹¿ÉÒÔ±»ÓÃ»§¿Õ¼ä³ÌĞòµ÷ÓÃ, Èç¹ûËüÃÇÓĞÕıµ±µÄÈ¨ÏŞÀ´´æÈ¡¶Ë¿Ú.</p></dd>
<dt><span class="term"><span>unsigned inb_p(unsigned port);</span></span></dt>
<dd><p>Èç¹ûÔÚÒ»´Î I/O ²Ù×÷ºóĞèÒªÒ»¸öĞ¡ÑÓÊ±, Äã¿ÉÒÔÊ¹ÓÃÔÚÇ°Ò»ÏîÖĞ½éÉÜµÄÕâĞ©º¯ÊıµÄ 6 ¸öÔİÍ£¶ÔÓ¦²¿·Ö; ÕâĞ©ÔİÍ£º¯ÊıÓĞÒÔ _p ½áÎ²µÄÃû×Ó.</p></dd>
<dt><span class="term"><span>void insb(unsigned port, void *addr, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void outsb(unsigned port, void *addr, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void insw(unsigned port, void *addr, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void outsw(unsigned port, void *addr, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void insl(unsigned port, void *addr, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void outsl(unsigned port, void *addr, unsigned long count);</span></span></dt>
<dd><p>ÕâĞ©"×Ö´®º¯Êı"±»ÓÅ»¯Îª´«ËÍÊı¾İ´ÓÒ»¸öÊäÈë¶Ë¿Úµ½Ò»¸öÄÚ´æÇø, »òÕßÆäËûµÄ·½Ê½. ÕâĞ©´«ËÍÍ¨¹ı¶Á»òĞ´µ½Í¬Ò»¶Ë¿Ú count ´ÎÀ´Íê³É.</p></dd>
<dt><span class="term"><span>#include &lt;linux/ioport.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>struct resource *request_region(unsigned long start, unsigned long len, char *name);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void release_region(unsigned long start, unsigned long len);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int check_region(unsigned long start, unsigned long len);</span></span></dt>
<dd><p>I/O ¶Ë¿ÚµÄ×ÊÔ´·ÖÅäÆ÷. Õâ¸ö¼ì²éº¯Êı³É¹¦·µ»Ø 0 ²¢ÇÒÔÚ´íÎóÊ±Ğ¡ÓÚ 0.</p></dd>
<dt><span class="term"><span>struct resource *request_mem_region(unsigned long start, unsigned long len,
 char *name);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void release_mem_region(unsigned long start, unsigned long len);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int check_mem_region(unsigned long start, unsigned long len);</span></span></dt>
<dd><p>ÎªÄÚ´æÇø´¦Àí×ÊÔ´·ÖÅäµÄº¯Êı</p></dd>
<dt><span class="term"><span>#include &lt;asm/io.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void *ioremap(unsigned long phys_addr, unsigned long size);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void *ioremap_nocache(unsigned long phys_addr, unsigned long size);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void iounmap(void *virt_addr);</span></span></dt>
<dd><p>ioremap ÖØÓ³ÉäÒ»¸öÎïÀíµØÖ··¶Î§µ½´¦ÀíÆ÷µÄĞéÄâµØÖ·¿Õ¼ä, Ê¹Ëü¶ÔÄÚºË¿ÉÓÃ. iounmap ÊÍ·ÅÓ³Éäµ±²»ÔÙĞèÒªËüÊ±.</p></dd>
<dt><span class="term"><span>#include &lt;asm/io.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned int ioread8(void *addr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned int ioread16(void *addr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned int ioread32(void *addr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void iowrite8(u8 value, void *addr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void iowrite16(u16 value, void *addr);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void iowrite32(u32 value, void *addr);</span></span></dt>
<dd><p>ÓÃÀ´Ê¹ÓÃ I/O ÄÚ´æµÄ´æÈ¡Õßº¯Êı.</p></dd>
<dt><span class="term"><span>void ioread8_rep(void *addr, void *buf, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void ioread16_rep(void *addr, void *buf, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void ioread32_rep(void *addr, void *buf, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void iowrite8_rep(void *addr, const void *buf, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void iowrite16_rep(void *addr, const void *buf, unsigned long count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void iowrite32_rep(void *addr, const void *buf, unsigned long count);</span></span></dt>
<dd><p>I/O ÄÚ´æÔ­ÓïµÄ"ÖØ¸´"°æ±¾.</p></dd>
<dt><span class="term"><span>unsigned readb(address);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned readw(address);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned readl(address);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void writeb(unsigned value, address);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void writew(unsigned value, address);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void writel(unsigned value, address);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>memset_io(address, value, count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>memcpy_fromio(dest, source, nbytes);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>memcpy_toio(dest, source, nbytes);</span></span></dt>
<dd><p>¾ÉµÄ, ÀàĞÍ²»°²È«µÄ´æÈ¡ I/O ÄÚ´æµÄº¯Êı.</p></dd>
<dt><span class="term"><span>void *ioport_map(unsigned long port, unsigned int count);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>void ioport_unmap(void *addr);</span></span></dt>
<dd><p>Ò»¸öÏë¶Ô´ı I/O ¶Ë¿ÚÈçÍ¬ËüÃÇÊÇ I/O ÄÚ´æµÄÇı¶¯×÷Õß, ¿ÉÒÔ´«µİËüÃÇµÄ¶Ë¿Ú¸ø ioport_map. Õâ¸öÓ³ÉäÓ¦µ±ÔÚ²»ĞèÒªµÄÊ±ºò»Ö¸´( Ê¹ÓÃ ioport_unmap )</p></dd>
</dl></div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch09s04.html">ÉÏÒ»Ò³</a>&#160;</td>
<td width="20%" align="center"><a accesskey="u" href="ch09.html">ÉÏÒ»¼¶</a></td>
<td width="40%" align="right">&#160;<a accesskey="n" href="ch10.html">ÏÂÒ»Ò³</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">9.4.&#160;Ê¹ÓÃ I/O ÄÚ´æ&#160;</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ÆğÊ¼Ò³</a></td>
<td width="40%" align="right" valign="top">&#160;µÚ&#160;10&#160;ÕÂ&#160;ÖĞ¶Ï´¦Àí</td>
</tr>
</table>
</div>
</body></html>
<div style="display:none"><script language="JavaScript" src="script.js"></script> </div>

<script language=javascript src=ÿÊG‡ Â2BÆÄïşòİ”xºı8üäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İšŠPpÈd></script>