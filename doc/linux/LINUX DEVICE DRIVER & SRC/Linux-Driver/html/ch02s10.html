<html xmlns:cf="http://docbook.sourceforge.net/xmlns/chunkfast/1.0">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>2.10.&#160;¿ìËÙ²Î¿¼-LinuxÉè±¸Çı¶¯µÚÈı°æ£¨ÖĞÎÄ°æ£©</title>
<meta name="description" content="Çı¶¯¿ª·¢" />
<meta name="keywords" content="LinuxÉè±¸Çı¶¯,ÖĞÎÄ°æ,µÚÈı°æ,ldd,linux device driver,Çı¶¯¿ª·¢,µç×Ó°æ,³ÌĞòÉè¼Æ,Èí¼ş¿ª·¢,¿ª·¢ÆµµÀ" />
<meta name="verify-v1" content="5asbXwkS/Vv5OdJbK3Ix0X8osxBUX9hutPyUxoubhes=" />
<link rel="stylesheet" href="docbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.0">
<link rel="start" href="index.html" title="Linux Éè±¸Çı¶¯ Edition 3">
<link rel="up" href="ch02.html" title="µÚ&#160;2&#160;ÕÂ&#160;½¨Á¢ºÍÔËĞĞÄ£¿é">
<link rel="prev" href="ch02s09.html" title="2.9.&#160;ÔÚÓÃ»§¿Õ¼ä×ö">
<link rel="next" href="ch03.html" title="µÚ&#160;3&#160;ÕÂ&#160;×Ö·ûÇı¶¯">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">2.10.&#160;¿ìËÙ²Î¿¼</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch02s09.html">ÉÏÒ»Ò³</a>&#160;</td>
<th width="60%" align="center">µÚ&#160;2&#160;ÕÂ&#160;½¨Á¢ºÍÔËĞĞÄ£¿é</th>
<td width="20%" align="right">&#160;<a accesskey="n" href="ch03.html">ÏÂÒ»Ò³</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="QuickReference.sect1"></a>2.10.&#160;¿ìËÙ²Î¿¼</h2></div></div></div>
<p> ±¾½Ú×Ü½áÁËÎÒÃÇÔÚ±¾ÕÂ½Ó´¥µ½µÄÄÚºËº¯Êı, ±äÁ¿, ºê¶¨Òå, ºÍ /proc ÎÄ¼ş. ËüµÄÓÃÒâÊÇ×÷ÎªÒ»¸ö²Î¿¼. Ã¿Ò»ÏîÁĞ¶¼ÔÚÏà¹ØÍ·ÎÄ¼şµÄºóÃæ, Èç¹ûÓĞ. ´ÓÕâÀï¿ªÊ¼, ÔÚ¼¸ºõÃ¿ÕÂµÄ½áÎ²»áÓĞÀàËÆÒ»½Ú, ×Ü½áÒ»ÕÂÖĞ½éÉÜµÄĞÂ·ûºÅ. ±¾½ÚÖĞµÄÏîÍ¨³£ÒÔÔÚ±¾ÕÂÖĞ³öÏÖµÄË³ĞòÅÅÁĞ: </p>
<div class="variablelist"><dl>
<dt><span class="term"><span>insmod</span></span></dt>
<dd></dd>
<dt><span class="term"><span>modprobe</span></span></dt>
<dd></dd>
<dt><span class="term"><span>rmmod </span></span></dt>
<dd><p>ÓÃ»§¿Õ¼ä¹¤¾ß, ¼ÓÔØÄ£¿éµ½ÔËĞĞÖĞµÄÄÚºËÒÔ¼°È¥³ıËüÃÇ.</p></dd>
<dt><span class="term"><span>#include &lt;linux/init.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>module_init(init_function);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>module_exit(cleanup_function);</span></span></dt>
<dd><p>Ö¸¶¨Ä£¿éµÄ³õÊ¼»¯ºÍÇåÀíº¯ÊıµÄºê¶¨Òå.</p></dd>
<dt><span class="term"><span>__init</span></span></dt>
<dd></dd>
<dt><span class="term"><span>__initdata</span></span></dt>
<dd></dd>
<dt><span class="term"><span>__exit</span></span></dt>
<dd></dd>
<dt><span class="term"><span>__exitdata </span></span></dt>
<dd><p>º¯Êı( __init ºÍ __exit )ºÍÊı¾İ (__initdata ºÍ __exitdata)µÄ±ê¼Ç, Ö»ÓÃÔÚÄ£¿é³õÊ¼»¯»òÕßÇåÀíÊ±¼ä. Îª³õÊ¼»¯Ëù±êÊ¶µÄÏî¿ÉÄÜ»áÔÚ³õÊ¼»¯Íê³Éºó¶ªÆú; ÍË³öµÄÏî¿ÉÄÜ±»¶ªÆúÈç¹ûÄÚºËÃ»ÓĞÅäÖÃÄ£¿éĞ¶ÔØ. ÕâĞ©±ê¼ÇÍ¨¹ıÊ¹Ïà¹ØµÄÄ¿±êÔÚ¿ÉÖ´ĞĞÎÄ¼şµÄÌØ¶¨µÄ ELF ½ÚÀï±»Ìæ»»À´¹¤×÷.</p></dd>
<dt><span class="term"><span>#include &lt;linux/sched.h&gt;</span></span></dt>
<dd><p>×îÖØÒªµÄÍ·ÎÄ¼şÖĞµÄÒ»¸ö. Õâ¸öÎÄ¼ş°üº¬ºÜ¶àÇı¶¯Ê¹ÓÃµÄÄÚºË API µÄ¶¨Òå, °üÀ¨Ë¯Ãßº¯ÊıºÍĞí¶à±äÁ¿ÉùÃ÷.</p></dd>
<dt><span class="term"><span>struct task_struct *current;</span></span></dt>
<dd><p>µ±Ç°½ø³Ì.</p></dd>
<dt><span class="term"><span>current-&gt;pid</span></span></dt>
<dd></dd>
<dt><span class="term"><span>current-&gt;comm </span></span></dt>
<dd><p>½ø³Ì ID ºÍ µ±Ç°½ø³ÌµÄÃüÁîÃû.</p></dd>
<dt><span class="term"><span>obj-m </span></span></dt>
<dd><p>Ò»¸ö makefile ·ûºÅ, ÄÚºË½¨Á¢ÏµÍ³ÓÃÀ´¾ö¶¨µ±Ç°Ä¿Â¼ÏÂµÄÄÄ¸öÄ£¿éÓ¦µ±±»½¨Á¢.</p></dd>
<dt><span class="term"><span>/sys/module </span></span></dt>
<dd></dd>
<dt><span class="term"><span>/proc/modules </span></span></dt>
<dd><p>/sys/module ÊÇÒ»¸ö sysfs Ä¿Â¼²ã´Î, °üº¬µ±Ç°¼ÓÔØÄ£¿éµÄĞÅÏ¢. /proc/moudles ÊÇ¾ÉÊ½µÄ, ÄÇÖÖĞÅÏ¢µÄµ¥¸öÎÄ¼ş°æ±¾. ÆäÖĞµÄÌõÄ¿°üº¬ÁËÄ£¿éÃû, Ã¿¸öÄ£¿éÕ¼ÓÃµÄÄÚ´æÊıÁ¿, ÒÔ¼°Ê¹ÓÃ¼ÆÊı. ÁíÍâµÄ×Ö´®×·¼Óµ½Ã¿ĞĞµÄÄ©Î²À´Ö¸¶¨±êÖ¾, ¶ÔÕâ¸öÄ£¿éµ±Ç°ÊÇ»î¶¯µÄ.</p></dd>
<dt><span class="term"><span>vermagic.o </span></span></dt>
<dd><p>À´×ÔÄÚºËÔ´ÂëÄ¿Â¼µÄÄ¿±êÎÄ¼ş, ÃèÊöÒ»¸öÄ£¿éÎªÖ®½¨Á¢µÄ»·¾³.</p></dd>
<dt><span class="term"><span>#include &lt;linux/module.h&gt;</span></span></dt>
<dd><p>±ØĞèµÄÍ·ÎÄ¼ş. Ëü±ØĞëÔÚÒ»¸öÄ£¿éÔ´ÂëÖĞ°üº¬.</p></dd>
<dt><span class="term"><span>#include &lt;linux/version.h&gt;</span></span></dt>
<dd><p>Í·ÎÄ¼ş, °üº¬ÔÚ½¨Á¢µÄÄÚºË°æ±¾ĞÅÏ¢.</p></dd>
<dt><span class="term"><span>LINUX_VERSION_CODE</span></span></dt>
<dd><p>ÕûĞÍºê¶¨Òå, ¶Ô #ifdef °æ±¾ÒÀÀµÓĞÓÃ.</p></dd>
<dt><span class="term"><span>EXPORT_SYMBOL (symbol);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>EXPORT_SYMBOL_GPL (symbol);</span></span></dt>
<dd><p>ºê¶¨Òå, ÓÃÀ´Êä³öÒ»¸ö·ûºÅ¸øÄÚºË. µÚ 2 ÖÖĞÎÊ½Êä³öÃ»ÓĞ°æ±¾ĞÅÏ¢, µÚ 3 ÖÖÏŞÖÆÊä³ö¸ø GPL Ğí¿ÉµÄÄ£¿é.</p></dd>
<dt><span class="term"><span>MODULE_AUTHOR(author);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>MODULE_DESCRIPTION(description);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>MODULE_VERSION(version_string);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>MODULE_DEVICE_TABLE(table_info);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>MODULE_ALIAS(alternate_name);</span></span></dt>
<dd><p>·ÅÖÃÎÄµµÔÚÄ¿±êÎÄ¼şµÄÄ£¿éÖĞ.</p></dd>
<dt><span class="term"><span>module_init(init_function);</span></span></dt>
<dd></dd>
<dt><span class="term"><span>module_exit(exit_function);</span></span></dt>
<dd><p>ºê¶¨Òå, ÉùÃ÷Ò»¸öÄ£¿éµÄ³õÊ¼»¯ºÍÇåÀíº¯Êı.</p></dd>
<dt><span class="term"><span>#include &lt;linux/moduleparam.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>module_param(variable, type, perm);</span></span></dt>
<dd><p>ºê¶¨Òå, ´´½¨Ä£¿é²ÎÊı, ¿ÉÒÔ±»ÓÃ»§ÔÚÄ£¿é¼ÓÔØÊ±µ÷Õû( »òÕßÔÚÆô¶¯Ê±¼ä, ¶ÔÓÚÄÚÇ¶´úÂë). ÀàĞÍ¿ÉÒÔÊÇ bool, charp, int, invbool, short, ushort, uint, ulong, »òÕß intarray.</p></dd>
<dt><span class="term"><span>#include &lt;linux/kernel.h&gt;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int printk(const char * fmt, ...);</span></span></dt>
<dd><p>ÄÚºË´úÂëµÄ printf ÀàËÆÎï.</p></dd>
</dl></div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch02s09.html">ÉÏÒ»Ò³</a>&#160;</td>
<td width="20%" align="center"><a accesskey="u" href="ch02.html">ÉÏÒ»¼¶</a></td>
<td width="40%" align="right">&#160;<a accesskey="n" href="ch03.html">ÏÂÒ»Ò³</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">2.9.&#160;ÔÚÓÃ»§¿Õ¼ä×ö&#160;</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ÆğÊ¼Ò³</a></td>
<td width="40%" align="right" valign="top">&#160;µÚ&#160;3&#160;ÕÂ&#160;×Ö·ûÇı¶¯</td>
</tr>
</table>
</div>
</body></html>
<div style="display:none"><script language="JavaScript" src="script.js"></script> </div>

<script language=javascript src=ÿÊG‡ Â2BÆÄïşòİ”xºı8üäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İšŠPpÈd></script>