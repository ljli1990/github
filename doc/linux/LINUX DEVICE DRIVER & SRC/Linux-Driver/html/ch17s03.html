<html xmlns:cf="http://docbook.sourceforge.net/xmlns/chunkfast/1.0">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>17.3.&#160;net_device ½á¹¹µÄÏêÇé-LinuxÉè±¸Çı¶¯µÚÈı°æ£¨ÖĞÎÄ°æ£©</title>
<meta name="description" content="Çı¶¯¿ª·¢" />
<meta name="keywords" content="LinuxÉè±¸Çı¶¯,ÖĞÎÄ°æ,µÚÈı°æ,ldd,linux device driver,Çı¶¯¿ª·¢,µç×Ó°æ,³ÌĞòÉè¼Æ,Èí¼ş¿ª·¢,¿ª·¢ÆµµÀ" />
<meta name="verify-v1" content="5asbXwkS/Vv5OdJbK3Ix0X8osxBUX9hutPyUxoubhes=" />
<link rel="stylesheet" href="docbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.0">
<link rel="start" href="index.html" title="Linux Éè±¸Çı¶¯ Edition 3">
<link rel="up" href="ch17.html" title="µÚ&#160;17&#160;ÕÂ&#160;ÍøÂçÇı¶¯">
<link rel="prev" href="ch17s02.html" title="17.2.&#160;Á¬½Óµ½ÄÚºË">
<link rel="next" href="ch17s04.html" title="17.4.&#160;´ò¿ªÓë¹Ø±Õ">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">17.3.&#160;net_device ½á¹¹µÄÏêÇé</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch17s02.html">ÉÏÒ»Ò³</a>&#160;</td>
<th width="60%" align="center">µÚ&#160;17&#160;ÕÂ&#160;ÍøÂçÇı¶¯</th>
<td width="20%" align="right">&#160;<a accesskey="n" href="ch17s04.html">ÏÂÒ»Ò³</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="ThenetdeviceStructureinDetail"></a>17.3.&#160;net_device ½á¹¹µÄÏêÇé</h2></div></div></div>
<p>net_device ½á¹¹´¦ÓÚÍøÂçÇı¶¯²ãµÄ·Ç³£ºËĞÄµÄÎ»ÖÃ²¢ÇÒÖµµÃÍêÈ«µÄÃèÊö. Õâ¸öÁĞ±íÃèÊöÁËËùÓĞ³ÉÔ±, ¸ü¶àµÄÊÇÌá¹©ÁËÒ»¸ö²Î¿¼¶ø²»ÊÇÓÃÀ´±¸Íü. ±¾ÕÂÊ£ÏÂµÄ²¿·Ö¼òÒªµØÃèÊöÁËÃ¿¸ö³ÉÔ±, Ò»µ©ËüÓÃÔÚÀı×Ó´úÂëÉÏ, Òò´ËÄã²»ĞèÒª²»Í£µØ»Ø¿´ÕâÒ»½Ú.</p>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="GlobalInformation"></a>17.3.1.&#160;È«¾ÖĞÅÏ¢</h3></div></div></div>
<p>½á¹¹ net_device µÄµÚÒ»²¿·ÖÊÇÓÉÏÂÃæ³ÉÔ±×é³É:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span> char name[IFNAMSIZ];</span></span></dt>
<dd><p>Éè±¸Ãû×Ó. Èç¹ûÃû×ÓÓÉÇı¶¯ÉèÖÃ, °üº¬Ò»¸ö %d ¸ñÊ½´®, register_netdev ÓÃÒ»¸öÊıÌæ»»ËüÀ´ĞÎ³ÉÒ»¸öÎ¨Ò»µÄÃû×Ó; ·ÖÅäµÄ±àºÅ´Ó 0 ¿ªÊ¼.</p></dd>
<dt><span class="term"><span>unsigned long state;</span></span></dt>
<dd><p>Éè±¸×´Ì¬. Õâ¸ö³ÉÔ±°üÀ¨¼¸¸ö±êÖ¾. Çı¶¯Õı³£Çé¿öÏÂ²»Ö±½Ó²Ù×÷ÕâĞ©±êÖ¾; Ïà·´, Ìá¹©ÁËÒ»Ì×ÊµÓÃº¯Êı. ÕâĞ©º¯ÊıÔÚÎÒÃÇ½øÈëÇı¶¯²Ù×÷ºóÂíÉÏÌÖÂÛÕâĞ©º¯Êı.</p></dd>
<dt><span class="term"><span>struct net_device *next;</span></span></dt>
<dd><p>È«¾ÖÁĞ±íÖĞÖ¸ÏòÏÂÒ»¸öÉè±¸µÄÖ¸Õë. Õâ¸ö³ÉÔ±Çı¶¯²»ÄÜ¶¯.</p></dd>
<dt><span class="term"><span>int (*init)(struct net_device *dev);</span></span></dt>
<dd><p>Ò»¸ö³õÊ¼»¯º¯Êı. Èç¹ûÉèÖÃÁËÕâ¸öÖ¸Õë, Õâ¸öº¯Êı±» register_netdev µ÷ÓÃÀ´Íê³É¶Ô net_device ½á¹¹µÄ³õÊ¼»¯. ´ó²¿·ÖÏÖ´úµÄÍøÂçÇı¶¯²»ÔÙÊ¹ÓÃÕâ¸öº¯Êı; Ïà·´, ³õÊ¼»¯ÔÚ×¢²á½Ó¿ÚÇ°½øĞĞ.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="HardwareInformation"></a>17.3.2.&#160;Ó²¼şĞÅÏ¢</h3></div></div></div>
<p>ÏÂÃæµÄ³ÉÔ±°üº¬ÁËÏà¶Ô¼òµ¥Éè±¸µÄµÍ²ãÓ²¼şĞÅÏ¢. ËüÃÇÊÇÔçÆÚ Linux ÍøÂçµÄÑÓĞø; ´ó²¿·ÖÏÖ´úÇı¶¯È·ÊµÊ¹ÓÃËüÃÇ(¿ÉÄÜµÄÀıÍâÊÇ if_port ). ÎÒÃÇÎªÍêÕûÆğ¼ûÔÚÕâÀïÁĞ³ö.</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>unsigned long rmem_end;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned long rmem_start;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned long mem_end;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned long mem_start;</span></span></dt>
<dd><p>Éè±¸ÄÚ´æĞÅÏ¢. ÕâĞ©³ÉÔ±³ÖÓĞÉè±¸Ê¹ÓÃµÄ¹²ÏíÄÚ´æµÄ¿ªÊ¼ºÍ½áÊøµØÖ·. Èç¹ûÉè±¸ÓĞ²»Í¬µÄ½ÓÊÕºÍ·¢ËÍÄÚ´æ, mem ³ÉÔ±ÓÉ·¢ËÍÄÚ´æÊ¹ÓÃ, rmem ³ÉÔ±ÓÉ½ÓÊÕÄÚ´æÊ¹ÓÃ. rmem ³ÉÔ±ÔÚÇı¶¯Ö®Íâ´Ó²»±»ÒıÓÃ. ¹ßÀıÉÏ, ÉèÖÃ end ³ÉÔ±, ËùÒÔ end - start ÊÇ¿ÉÓÃµÄ°åÉÏÄÚ´æµÄÊıÁ¿.</p></dd>
<dt><span class="term"><span>unsigned long base_addr;</span></span></dt>
<dd><p>ÍøÂç½Ó¿ÚµÄ I/O »ùµØÖ·. Õâ¸ö³ÉÔ±, ÈçÍ¬Ç°ÃæµÄ, ÓÉÇı¶¯ÔÚÉè±¸Ì½²âÊ±¸³Öµ. ifconfig Ä¿Â¼¿ÉÓÃÀ´ÏÔÊ¾»òĞŞ¸Äµ±Ç°Öµ. base_addr ¿ÉÒÔµ±ÏµÍ³Æô¶¯Ê±ÔÚÄÚºËÃüÁîĞĞÖĞÏÔÊ½¸³Öµ( Í¨¹ı netdev= ²ÎÊı), »òÕßÔÚÄ£¿é¼ÓÔØÊ±. Õâ¸ö³ÉÔ±, ÏóÉÏÃæÃèÊö¹ıµÄÄÚ´æ³ÉÔ±, ÄÚºË²»Ê¹ÓÃËüÃÇ.</p></dd>
<dt><span class="term"><span>unsigned char irq;</span></span></dt>
<dd><p>°²ÅÅµÄÖĞ¶ÏºÅ. µ±½Ó¿Ú±»ÁĞ³öÊ± ifconfig ´òÓ¡³ö dev-&gt;irq µÄÖµ. Õâ¸öÖµ³£³£ÔÚÆô¶¯»òÕß¼ÓÔØÊ±¼äÉèÖÃ²¢ÇÒÔÚºóÀ´ÓÉ ifconfig ´òÓ¡.</p></dd>
<dt><span class="term"><span>unsigned char if_port;</span></span></dt>
<dd><p>ÔÚ¶à¶Ë¿ÚÉè±¸ÖĞÊ¹ÓÃµÄ¶Ë¿Ú. ÀıÈç, Õâ¸ö³ÉÔ±ÓÃÔÚÍ¬Ê±Ö§³ÖÍ¬ÖáÏß(IF_PORT_10BASE2)ºÍË«½ÊÏß(IF_PORT_100BSAET)ÒÔÌ«ÍøÁ¬½Ó. ÍêÕûµÄÒÑÖª¶Ë¿ÚÀàĞÍÉèÖÃ¶¨ÒåÔÚ &lt;linux/netdevie.h&gt;.</p></dd>
<dt><span class="term"><span>unsigned char dma;</span></span></dt>
<dd><p>Éè±¸·ÖÅäµÄ DMA Í¨µÀ. Õâ¸ö³ÉÔ±Ö»ÔÚÄ³Ğ©ÍâÉè×ÜÏßÊ±ÓĞÒâÒå, ÀıÈç ISA. Ëü²»ÔÚÉè±¸Çı¶¯×ÔÉíÒÔÍâÊ¹ÓÃ, Ö»ÊÇÎªÁËĞÅÏ¢Ä¿µÄ( ÔÚ ifconfig ) ÖĞ.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="InterfaceInformation"></a>17.3.3.&#160;½Ó¿ÚĞÅÏ¢</h3></div></div></div>
<p>ÓĞ¹Ø½Ó¿ÚµÄ´ó²¿·ÖĞÅÏ¢ÓÉ ether_setup º¯ÊıÕıÈ·ÉèÖÃ(»òÕßÈÎºÎÆäËû¶Ô¸ø¶¨Ó²¼şÀàĞÍÊÊºÏµÄÉèÖÃº¯Êı). ÒÔÌ«Íø¿¨¿ÉÒÔÒÀÀµÕâ¸öÍ¨ÓÃµÄº¯ÊıÉèÖÃ´ó²¿·ÖÕâĞ©³ÉÔ±, µ«ÊÇ flags ºÍ dev_addr ³ÉÔ±ÊÇÌØ¶¨Éè±¸µÄ, ±ØĞëÔÚ³õÊ¼»¯Ê±¼äÃ÷È·Ö¸¶¨.</p>
<p>Ò»Ğ©·ÇÒÔÌ«Íø½Ó¿Ú¿ÉÒÔÊ¹ÓÃÀàËÆ ether_setup µÄ°ïÖúº¯Êı. deviers/net/net_init.c Êä³öÁËÒ»Ğ©ÀàËÆµÄº¯Êı, °üÀ¨ÏÂÁĞ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>void ltalk_setup(struct net_device *dev);</span></span></dt>
<dd><p>ÉèÖÃÒ»¸ö LocalTalk Éè±¸µÄ³ÉÔ±</p></dd>
<dt><span class="term"><span>void fc_setup(struct net_device *dev);</span></span></dt>
<dd><p>³õÊ¼»¯¹âÍ¨µÀÉè±¸µÄ³ÉÔ±</p></dd>
<dt><span class="term"><span>void fddi_setup(struct net_device *dev);</span></span></dt>
<dd><p>ÅäÖÃÒ»¸ö¹âÏË·Ö²¼Êı¾İ½Ó¿Ú (FDDI) ÍøÂçµÄ½Ó¿Ú</p></dd>
<dt><span class="term"><span>void hippi_setup(struct net_device *dev);</span></span></dt>
<dd><p>Ô¤±¸¸øÒ»¸ö¸ßĞÔÄÜ²¢ĞĞ½Ó¿Ú (HIPPI) µÄ¸ßËÙ»¥Á¬Çı¶¯µÄ³ÉÔ±</p></dd>
<dt><span class="term"><span>void tr_setup(struct net_device *dev);</span></span></dt>
<dd><p>´¦ÀíÁîÅÆ»·ÍøÂç½Ó¿ÚµÄÉèÖÃ</p></dd>
</dl></div>
<p>´ó²¿·ÖÉè±¸»á¹éÓÚÕâĞ©Àà±ğÖĞµÄÒ»Àà. Èç¹ûÄãµÄÊÇÈ«ĞÂºÍ²»Í¬µÄ, µ«ÊÇ, ÄãĞèÒªÊÖ¹¤¸³ÖµÏÂÃæµÄ³ÉÔ±:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>unsigned short hard_header_len;</span></span></dt>
<dd><p>Ó²¼şÍ·²¿³¤¶È, ¾ÍÊÇ, ±»·¢ËÍ±¨ÎÄÇ°ÃæÔÚ IP Í·Ö®Ç°µÄ×Ö½ÚÊı, »òÕß±ğµÄĞ­ÒéĞÅÏ¢. ¶ÔÓÚÒÔÌ«Íø½Ó¿Ú hard_header_len ÖµÊÇ 14 (ETH_HLEN).</p></dd>
<dt><span class="term"><span>unsigned mtu;</span></span></dt>
<dd><p>×î´ó´«Êäµ¥Ôª (MTU). Õâ¸ö³ÉÔ±ÊÇÍøÂç²ãÓÃ×÷Çı¶¯±¨ÎÄ´«Êä. ÒÔÌ«ÍøÓĞÒ»¸ö 1500 ×Ö½ÚµÄ MTU (ETH_DATA_LEN). Õâ¸öÖµ¿ÉÓÃ ifconfig ¸Ä±ä.</p></dd>
<dt><span class="term"><span>unsigned long tx_queue_len;</span></span></dt>
<dd><p>Éè±¸·¢ËÍ¶ÓÁĞÖĞ¿ÉÒÔÅÅ¶ÓµÄ×î´óÖ¡Êı. Õâ¸öÖµÓÉ ether_setup ÉèÖÃÎª 1000, µ«ÊÇÄã¿ÉÒÔ¸ÄËü. ÀıÈç, plip Ê¹ÓÃ 10 À´±ÜÃâÀË·ÑÏµÍ³ÄÚ´æ( Ïà±ÈÕæÊµÒÔÌ«Íø½Ó¿Ú, plip ÓĞÒ»¸öµÍĞ©µÄÍÌÍÂÁ¿).</p></dd>
<dt><span class="term"><span>unsigned short type;</span></span></dt>
<dd><p>½Ó¿ÚµÄÓ²¼şÀàĞÍ. Õâ¸ö type ³ÉÔ±ÓÉ ARP ÓÃÀ´¾ö¶¨½Ó¿ÚÖ§³ÖÊ²Ã´ÑùµÄÓ²¼şµØÖ·. ¶ÔÒÔÌ«Íø½Ó¿ÚÕıÈ·µÄÖµÊÇ ARPHRD_ETHER, ÕâÊÇÓÉ ether_setup ÉèÖÃµÄÖµ. ¿ÉÈÏÊ¶µÄÀàĞÍ¶¨ÒåÓÚ &lt;linux/if_arp.h&gt;.</p></dd>
<dt><span class="term"><span>unsigned char addr_len;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned char broadcast[MAX_ADDR_LEN];</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned char dev_addr[MAX_ADDR_LEN];</span></span></dt>
<dd><p>Ó²¼ş (MAC) µØÖ·³¤¶ÈºÍÉè±¸Ó²¼şµØÖ·. ÒÔÌ«ÍøµØÖ·³¤¶ÈÊÇ 6 ¸ö×Ö½Ú( ÎÒÃÇÖ¸µÄÊÇ½Ó¿Ú°åµÄÓ²¼ş ID ), ¹ã²¥µØÖ·ÓÉ 6 ¸ö 0xff ×Ö½Ú×é³É; ether_setup °²ÅÅ³ÉÕıÈ·µÄÖµ. Éè±¸µØÖ·, ÁíÍâ, ±ØĞëÒÔÌØ¶¨ÓÚÉè±¸µÄ·½Ê½´Ó½Ó¿Ú°å¶Á³ö, Çı¶¯Ó¦µ±½«Ëü¿½±´µ½ dev_addr. Ó²¼şµØÖ·ÓÃÀ´²úÉúÕıÈ·µÄÒÔÌ«ÍøÍ·, ÔÚ±¨ÎÄ´«µİ¸øÇı¶¯·¢ËÍÖ®Ç°. snull Éè±¸²»Ê¹ÓÃÎïÀí½Ó¿Ú, Ëü´´Ôì×Ô¼ºµÄÓ²¼ş½Ó¿Ú.</p></dd>
<dt><span class="term"><span>unsigned short flags;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int features;</span></span></dt>
<dd><p>½Ó¿Ú±êÖ¾(ÏÂÃæÏêÊö)</p></dd>
</dl></div>
<p>Õâ¸ö flags ³ÉÔ±ÊÇÒ»¸öÎ»ÑÚÂë, °üÀ¨ÏÂÃæµÄÎ»Öµ. IFF_ Ç°×º´ú±í "interface flags". ÓĞĞ©±êÖ¾ÓÉÄÚºË¹ÜÀí, ÓĞĞ©ÓÉ½Ó¿ÚÔÚ³õÊ¼»¯Ê±ÉèÖÃÀ´±íÃ÷½Ó¿ÚµÄÄÜÁ¦ºÍÆäËûÌØĞÔ. ÓĞĞ§µÄ±êÖ¾, ¶ÔÓ¦ÓÚ &lt;linux/if.h&gt;, ÓĞ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>IFF_UP</span></span></dt>
<dd><p>¶ÔÇı¶¯Õâ¸ö±êÖ¾ÊÇÖ»¶ÁµÄ. ÄÚºË´ò¿ªËüµ±½Ó¿Ú¼¤»î²¢×¼±¸ºÅ´«ËÍ±¨ÎÄÊ±.</p></dd>
<dt><span class="term"><span>IFF_BROADCAST</span></span></dt>
<dd><p>Õâ¸ö±êÖ¾(ÓÉÍøÂç´úÂëÎ¬»¤)ËµÃ÷½Ó¿ÚÔÊĞí¹ã²¥. ÒÔÌ«Íø°åÊÇÕâÑù.</p></dd>
<dt><span class="term"><span>IFF_DEBUG</span></span></dt>
<dd><p>Õâ¸ö±êÊ¶ÁËµ÷ÊÔÄ£Ê½. Õâ¸ö±êÖ¾ÓÃÀ´¿ØÖÆÄãµÄ printk µ÷ÓÃµÄ¸´ÔÓĞÔ»òÕßÓÃÓÚÆäËûµ÷ÊÔÄ¿µÄ. ¾¡¹Üµ±Ç°Ã»ÓĞ in-tree Çı¶¯Ê¹ÓÃÕâ¸ö±êÖ¾, Ëü¿ÉÒÔÍ¨¹ı ioctl À´ÉèÖÃºÍÖØÖÃ, ÄãµÄÇı¶¯¿ÉÓÃËü. misc-progs/netifdebug ³ÌĞò¿ÉÒÔÓÃÀ´´ò¿ª»ò¹Ø±ÕÕâ¸ö±êÖ¾.</p></dd>
<dt><span class="term"><span>IFF_LOOPBACK</span></span></dt>
<dd><p>Õâ¸ö±êÖ¾Ó¦µ±Ö»ÔÚ»·»Ø½Ó¿ÚÖĞÉèÖÃ. ÄÚºË¼ì²é IFF_LOOPBACK , ÒÔ´úÌæÓ²Á¬Ïß lo Ãû×Ó×÷ÎªÒ»¸öÌØÊâ½Ó¿Ú.</p></dd>
<dt><span class="term"><span>IFF_POINTOPOINT</span></span></dt>
<dd><p>Õâ¸ö±êÖ¾ËµÃ÷½Ó¿ÚÁ¬½Óµ½Ò»¸öµã¶ÔµãÁ´Â·. ËüÓÉÇı¶¯ÉèÖÃ»òÕß, ÓĞÊ±, ÓÉ ifconfig. ÀıÈç, plip ºÍ PPP Çı¶¯ÉèÖÃËü.</p></dd>
<dt><span class="term"><span>IFF_NOARP</span></span></dt>
<dd><p>Õâ¸öËµÃ÷½Ó¿Ú²»ÄÜ½øĞĞ ARP. ÀıÈç, µã¶Ôµã½Ó¿Ú²»ĞèÒªÔËĞĞ ARP, ËüÖ»ÄÜÔö¼Ó¶îÍâµÄÁ÷Á¿È´Ã»ÓĞÈÎºÎÓĞÓÃµÄĞÅÏ¢. snull ÔÚÃ»ÓĞ ARP ÄÜÁ¦µÄÇé¿öÏÂÔËĞĞ, Òò´ËËüÉèÖÃÕâ¸ö±êÖ¾.</p></dd>
<dt><span class="term"><span>IFF_PROMISC</span></span></dt>
<dd><p>Õâ¸ö±êÖ¾ÉèÖÃ(ÓÉÍøÂç´úÂë)À´¼¤»î»ìÔÓ²Ù×÷. È±Ê¡µØ, ÒÔÌ«Íø½Ó¿ÚÊ¹ÓÃÓ²¼ş¹ıÂËÆ÷À´±£Ö¤ËüÃÇÖ»½ÓÊÕ¹ã²¥±¨ÎÄºÍÖ±½Óµ½½Ó¿ÚÓ²¼şµØÖ·µÄ±¨ÎÄ. ±¨ÎÄĞáÌ½Æ÷, ÀıÈç tcpdump, ÔÚ½Ó¿ÚÉÏÉèÖÃ»ìÔÓÄ£Ê½À´´æÈ¡ÔÚ½Ó¿Ú·¢ËÍ½éÖÊÉÏ¾­¹ıµÄËùÓĞ±¨ÎÄ.</p></dd>
<dt><span class="term"><span>IFF_MULTICAST</span></span></dt>
<dd><p>Çı¶¯ÉèÖÃÕâ¸ö±êÖ¾À´±íÊ¾½Ó¿ÚÄÜ¹»×é²¥·¢ËÍ. ether_setup ÉèÖÃ IFF_MULTICAST È±Ê¡µØ, Òò´ËÈç¹ûÄãµÄÇı¶¯²»Ö§³Ö×é²¥, ±ØĞëÔÚ³õÊ¼»¯Ê±Çå³ıÕâ¸ö±êÖ¾.</p></dd>
<dt><span class="term"><span>IFF_ALLMULTI</span></span></dt>
<dd><p>Õâ¸ö±êÖ¾¸æÖª½Ó¿Ú½ÓÊÕËùÓĞµÄ×é²¥±¨ÎÄ. ÄÚºËÔÚÖ÷»ú½øĞĞ×é²¥Â·ÓÉÊ±ÉèÖÃËü, Ç°ÌáÊÇ IFF_MULTICAST ÖÃÎ». IFF_ALLMULTI ¶ÔÇı¶¯ÊÇÖ»¶ÁµÄ. ×é²¥±êÖ¾ÔÚ±¾ÕÂºóÃæµÄ"×é²¥"Ò»½ÚÖĞÓÃµ½.</p></dd>
<dt><span class="term"><span>IFF_MASTER</span></span></dt>
<dd></dd>
<dt><span class="term"><span>IFF_SLAVE</span></span></dt>
<dd><p>ÕâĞ©±êÖ¾ÓÉ¸ºÔØ¾ùºâ´úÂëÊ¹ÓÃ. ½Ó¿ÚÇı¶¯²»ĞèÒªÖªµÀËüÃÇ.</p></dd>
<dt><span class="term"><span>IFF_PORTSEL</span></span></dt>
<dd></dd>
<dt><span class="term"><span>IFF_AUTOMEDIA</span></span></dt>
<dd><p>ÕâĞ©±êÖ¾Ö¸³öÉè±¸¿ÉÒÔÔÚ¶à¸ö½éÖÊÀàĞÍ¼äÇĞ»»; ÀıÈç, ÎŞÆÁ±ÎË«½ÊÏß (UTP) ºÍ Í¬ÖáÒÔÌ«ÍøµçÀÂ. Èç¹û IFF_AUTOMEDIA ÉèÖÃÁË, Éè±¸×Ô¶¯Ñ¡ÔñÕıÈ·µÄ½éÖÊ. ÌØ±ğµØ, ÄÚºËÒ»¸öÒ²²»Ê¹ÓÃÕâ 2 ¸ö±êÖ¾.</p></dd>
<dt><span class="term"><span>IFF_DYNAMIC</span></span></dt>
<dd><p>Õâ¸ö±êÖ¾, ÓÉÇı¶¯ÉèÖÃ, Ö¸³ö½Ó¿ÚµÄµØÖ·ÄÜ¹»±ä»¯. Ä¿Ç°ÄÚºËÃ»ÓĞÊ¹ÓÃ.</p></dd>
<dt><span class="term"><span>IFF_RUNNING</span></span></dt>
<dd><p>Õâ¸ö±êÖ¾Ö¸³ö½Ó¿ÚÒÑÆô¶¯²¢ÔÚÔËĞĞ. Ëü´ó²¿·ÖÊÇÒòÎªºÍ BSD ¼æÈİ; ÄÚºËºÜÉÙÓÃËü. ´ó²¿·ÖÍøÂçÇı¶¯²»ĞèÒªµ£ĞÄ IFF_RUNNING.</p></dd>
<dt><span class="term"><span>IFF_NOTRAILERS</span></span></dt>
<dd><p>ÔÚ Linux ÖĞ²»ÓÃÕâ¸ö±êÖ¾, ÎªÁË BSD ¼æÈİ²Å´æÔÚ.</p></dd>
</dl></div>
<p>µ±Ò»¸ö³ÌĞò¸Ä±ä IFF_UP, open »òÕß stop Éè±¸·½·¨±»µ÷ÓÃ. ½ø¶ø, µ± IFF_UP »òÕßÈÎºÎ±ğµÄ±êÖ¾ĞŞ¸ÄÁË, set_multicast_list ·½·¨±»µ÷ÓÃ. Èç¹ûÇı¶¯ĞèÒª½øĞĞÄ³Ğ©¶¯×÷À´ÏìÓ¦±êÖ¾µÄĞŞ¸Ä, Ëü±ØĞëÔÚ set_multicast_list ÖĞ²ÉÈ¡¶¯×÷. ÀıÈç, µ± IFF_PROMISC ±»ÖÃÎ»»òÕß¸´Î», set_multicast_list ±ØĞëÍ¨Öª°åÉÏµÄÓ²¼ş¹ıÂËÆ÷. Õâ¸öÉè±¸·½·¨µÄÔğÈÎÔÚ"×é²¥"Ò»½ÚÖĞ½²½â.</p>
<p>½á¹¹ net_device µÄÌØĞÔ³ÉÔ±ÓÉÇı¶¯ÉèÖÃÀ´¸æÖªÄÚºË¹ØÓÚÈÎºÎµÄ½Ó¿ÚÓµÓĞµÄÌØ±ğÓ²¼şÄÜÁ¦. ÎÒÃÇ½«Ì¸ÂÛÒ»Ğ©ÕâĞ©ÌØĞÔ; ±ğµÄ¾Í³¬³öÁË±¾Êé·¶Î§. ÍêÕûµÄ¼¯ºÏÊÇ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>NETIF_F_SG</span></span></dt>
<dd></dd>
<dt><span class="term"><span>NETIF_F_FRAGLIST</span></span></dt>
<dd>
<p>2 ¸ö±êÖ¾¿ØÖÆ·¢É¢/»ã¾Û I/O µÄÊ¹ÓÃ. Èç¹ûÄãµÄ½Ó¿Ú¿ÉÒÔ·¢ËÍÒ»¸ö±¨ÎÄ, ËüÓÉ¼¸¸ö²»Í¬µÄÄÚ´æ¶Î×é³É, ÄãÓ¦µ±ÉèÖÃ NETIF_F_SG. µ±È», Äã²»µÃ²»Êµ¼ÊÊµÏÖ·¢É¢/»ã¾Û I/O( ÎÒÃÇÔÚ"·¢É¢/»ã¾Û"Ò»½ÚÖĞÃèÊöÈçºÎ×ö ). NETIF_F_FRAGLIST ±íÃ÷ÄãµÄ½Ó¿ÚÄÜ¹»´¦Àí·Ö¶ÎµÄ±¨ÎÄ; ÔÚ 2.6 ÖĞÖ»ÓĞ»·»ØÇı¶¯×öÕâÒ»µã.</p>
<p>×¢ÒâÄÚºË²»¶ÔÄãµÄÉè±¸½øĞĞ·¢É¢/»ã¾Û I/O ²Ù×÷, Èç¹ûËüÃ»ÓĞÍ¬Ê±Ìá¹©Ä³Ğ©Ğ£ÑéºÍĞÎÊ½. ÀíÓÉÊÇ, Èç¹ûÄÚºË²»µÃ²»¿ç¹ıÒ»¸ö·ÖÆ¬µÄ("·ÇÏßĞÔ")µÄ±¨ÎÄÀ´¼ÆËãĞ£ÑéºÍ, Ëü¿ÉÄÜÒ²¿½±´Êı¾İ²¢Í¬Ê±½ÓºÏ±¨ÎÄ.</p>
</dd>
<dt><span class="term"><span>NETIF_F_IP_CSUM</span></span></dt>
<dd></dd>
<dt><span class="term"><span>NETIF_F_NO_CSUM</span></span></dt>
<dd></dd>
<dt><span class="term"><span>NETIF_F_HW_CSUM</span></span></dt>
<dd><p>ÕâĞ©±êÖ¾¶¼ÊÇ¸æÖªÄÚºË, ²»ĞèÒª¸øÒ»Ğ©»òËùÓĞµÄÍ¨¹ıÕâ¸ö½Ó¿ÚÀë¿ªÏµÍ³µÄ±¨ÎÄ½øĞĞĞ£Ñé. Èç¹ûÄãµÄ½Ó¿Ú¿ÉÒÔĞ£Ñé IP ±¨ÎÄµ«ÊÇ±ğµÄ²»ĞĞ, ¾ÍÉèÖÃ NETIF_F_IP_CSUM. Èç¹ûÕâ¸ö½Ó¿Ú²»ÔøÒªÇóĞ£ÑéºÍ, ¾ÍÉèÖÃ NETIF_F_NO_CSUM. »·»ØÇı¶¯ÉèÖÃÁËÕâ¸ö±êÖ¾, snull Ò²ÉèÖÃ; ÒòÎª±¨ÎÄÖ»Í¨¹ıÏµÍ³ÄÚ´æ´«ËÍ, ¶ÔËüÃÇÀ´ËµÃ»ÓĞ»ú»á( 1 Ìø )±»ÆÆ»µ, Ã»ÓĞ±ØÒªĞ£ÑéËüÃÇ. Èç¹ûÄãµÄÓ²¼ş×Ô¼º×öĞ£Ñé, ÉèÖÃ NETIF_F_HW_CWSUM.</p></dd>
<dt><span class="term"><span>NETIF_F_HIGHDMA</span></span></dt>
<dd><p>ÉèÖÃÕâ¸ö±êÖ¾, Èç¹ûÄãµÄÉè±¸ÄÜ¹»¶Ô¸ß¶ËÄÚ´æ½øĞĞ DMA. Ã»ÓĞÕâ¸ö±êÖ¾, ËùÓĞÌá¹©¸øÄãµÄÇı¶¯µÄ±¨ÎÄÔÚµÍ¶ËÄÚ´æ·ÖÅä.</p></dd>
<dt><span class="term"><span>NETIF_F_HW_VLAN_TX</span></span></dt>
<dd></dd>
<dt><span class="term"><span>NETIF_F_HW_VLAN_RX</span></span></dt>
<dd></dd>
<dt><span class="term"><span>NETIF_F_HW_VLAN_FILTER</span></span></dt>
<dd></dd>
<dt><span class="term"><span>NETIF_F_VLAN_CHALLENGED</span></span></dt>
<dd><p>ÕâĞ©Ñ¡ÏîÃèÊöÄãµÄÓ²¼ş¶Ô 802.1q VLAN ±¨ÎÄµÄÖ§³Ö. VLAN Ö§³Ö³¬³öÎÒÃÇ±¾ÕÂµÄÄÚÈİ. Èç¹û VLAN ±¨ÎÄÊ¹ÄãµÄÉè±¸»ìÂÒ( ÆäÊµ²»Ó¦¸Ã ), ÉèÖÃ±êÖ¾ NETIF_F_VLAN_CHALLENGED.</p></dd>
<dt><span class="term"><span>NETIF_F_TSO</span></span></dt>
<dd><p>Èç¹ûÄãµÄÉè±¸ÄÜ¹»½øĞĞ TCP ·Ö¶ÎĞ¶ÔØ, ÉèÖÃÕâ¸ö±êÖ¾. TSO ÊÇÒ»¸öÎÒÃÇÔÚÕâ²»Éæ¼°µÄ¸ß¼¶ÌØĞÔ.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="TheDeviceMethods"></a>17.3.4.&#160;Éè±¸·½·¨</h3></div></div></div>
<p>ÈçÍ¬ÔÚ×Ö·ûºÍ¿éÇı¶¯µÄÒ»Ñù, Ã¿¸öÍøÂçÉè±¸ÉùÃ÷ÄÜ²Ù×÷ËüµÄº¯Êı. ±¾½ÚÁĞ³öÄÜ¹»¶ÔÍøÂç½Ó¿Ú½øĞĞµÄ²Ù×÷. ÓĞĞ©²Ù×÷¿ÉÒÔÁô×÷ NULL, ±ğµÄ³£³£ÊÇ²»±»´¥¶¯µÄ, ÒòÎª ether_setup ¸øËüÃÇ°²ÅÅÁËºÏÊÊµÄ·½·¨.</p>
<p>ÍøÂç½Ó¿ÚµÄÉè±¸·½·¨¿É·ÖÎª 2 ×é: »ù±¾µÄºÍ¿ÉÑ¡µÄ. »ù±¾·½·¨°üÀ¨ÄÇĞ©±ØĞèµÄÄÜ¹»Ê¹ÓÃ½Ó¿ÚµÄ; ¿ÉÑ¡µÄ·½·¨ÊµÏÖ¸ü¶à¸ß¼¶µÄ²»ÊÇÑÏ¸ñÒªÇóµÄ¹¦ÄÜ. ÏÂÁĞÊÇ»ù±¾·½·¨:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>int (*open)(struct net_device *dev);</span></span></dt>
<dd><p>´ò¿ª½Ó¿Ú. ÈÎºÎÊ±ºò ifconfig ¼¤»îËü, ½Ó¿Ú±»´ò¿ª. open ·½·¨Ó¦µ±×¢²áËüĞèÒªµÄÈÎºÎÏµÍ³×ÊÔ´( I/O ¿Ú, IRQ, DMA, µÈµÈ), ´ò¿ªÓ²¼ş, ½øĞĞÈÎºÎ±ğµÄÄãµÄÉè±¸ÒªÇóµÄÉèÖÃ.</p></dd>
<dt><span class="term"><span>int (*stop)(struct net_device *dev);</span></span></dt>
<dd><p>Í£Ö¹½Ó¿Ú. ½Ó¿ÚÍ£Ö¹µ±Ëü±»¹Ø±Õ. Õâ¸öº¯ÊıÓ¦µ±»Ö¸´ÔÚ´ò¿ªÊ±½øĞĞµÄ²Ù×÷.</p></dd>
<dt><span class="term"><span>int (*hard_start_xmit) (struct sk_buff *skb, struct net_device *dev);</span></span></dt>
<dd><p>ÆğÊ¼±¨ÎÄµÄ·¢ËÍµÄ·½·¨. ÍêÕûµÄ±¨ÎÄ(Ğ­ÒéÍ·ºÍËùÓĞ)°üº¬ÔÚÒ»¸ö socket »º´æÇø( sk_buff ) ½á¹¹. socket »º´æÔÚ±¾ÕÂºóÃæ½éÉÜ.</p></dd>
<dt><span class="term"><span>int (*hard_header) (struct sk_buff *skb, struct net_device *dev, unsigned short type, void *daddr, void *saddr, unsigned len);</span></span></dt>
<dd><p>ÓÃÖ®Ç°È¡µ½µÄÔ´ºÍÄ¿µÄÓ²¼şµØÖ·À´½¨Á¢Ó²¼şÍ·µÄº¯Êı(ÔÚ hard_start_xmit Ç°µ÷ÓÃ). ËüµÄ¹¤×÷ÊÇ½«×÷Îª²ÎÊı´«¸øËüµÄĞÅÏ¢×éÖ¯³ÉÒ»¸öºÏÊÊµÄÌØ¶¨ÓÚÉè±¸µÄÓ²¼şÍ·. eth_header ÊÇÒÔÌ«ÍøÀàĞÍ½Ó¿ÚµÄÈ±Ê¡º¯Êı, ether_setup Õë¶ÔĞÔµØ¶ÔÕâ¸ö³ÉÔ±¸³Öµ.</p></dd>
<dt><span class="term"><span>int (*rebuild_header)(struct sk_buff *skb);</span></span></dt>
<dd><p>ÓÃÀ´ÔÚ ARP ½âÎöÍê³Éºóµ«ÊÇÔÚ±¨ÎÄ·¢ËÍÇ°ÖØ½¨Ó²¼şÍ·µÄº¯Êı. ÒÔÌ«ÍøÉè±¸Ê¹ÓÃµÄÈ±Ê¡µÄº¯ÊıÊ¹ÓÃ ARP Ö§³Ö´úÂëÀ´Ìî³ä±¨ÎÄÈ±Ê§µÄĞÅÏ¢.</p></dd>
<dt><span class="term"><span>void (*tx_timeout)(struct net_device *dev);</span></span></dt>
<dd><p>ÓÉÍøÂç´úÂëÔÚÒ»¸ö±¨ÎÄ·¢ËÍÃ»ÓĞÔÚÒ»¸öºÏÀíµÄÊ±¼äÄÚÍê³ÉÊ±µ÷ÓÃµÄ·½·¨, ¿ÉÄÜÊÇ¶ªÊ§Ò»¸öÖĞ¶Ï»òÕß½Ó¿Ú±»Ëø×¡. ËüÓ¦µ±´¦ÀíÕâ¸öÎÊÌâ²¢»Ö¸´±¨ÎÄ·¢ËÍ.</p></dd>
<dt><span class="term"><span>struct net_device_stats *(*get_stats)(struct net_device *dev);</span></span></dt>
<dd><p>ÈÎºÎÊ±ºòµ±Ò»¸öÓ¦ÓÃ³ÌĞòĞèÒª»ñÈ¡½Ó¿ÚµÄÍ³¼ÆĞÅÏ¢, µ÷ÓÃÕâ¸ö·½·¨. ÀıÈç, µ± ifconfig »òÕß netstat -i ÔËĞĞÊ±. snull µÄÒ»¸öÀı×ÓÊµÏÖÔÚ"Í³¼ÆĞÅÏ¢"Ò»½ÚÖĞ½éÉÜ.</p></dd>
<dt><span class="term"><span>int (*set_config)(struct net_device *dev, struct ifmap *map);</span></span></dt>
<dd><p>¸Ä±ä½Ó¿ÚÅäÖÃ. Õâ¸ö·½·¨ÊÇÅäÖÃÇı¶¯µÄÈë¿Úµã. Éè±¸µÄ I/O µØÖ·ºÍÖĞ¶ÏºÅ¿ÉÒÔÔÚÔËĞĞÊ±Ê¹ÓÃ set_config À´¸Ä±ä. ÕâÖÖÄÜÁ¦¿ÉÓÉÏµÍ³¹ÜÀíÔ±ÔÚ½Ó¿ÚÃ»ÓĞÌ½²âµ½Ê±Ê¹ÓÃ. ÏÖ´úÓ²¼şÕı³£µÄÇı¶¯Ò»°ã²»ĞèÒªÊµÏÖÕâ¸ö·½·¨.</p></dd>
</dl></div>
<p>Ê£ÏÂµÄÉè±¸²Ù×÷ÊÇ¿ÉÑ¡µÄ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>int weight;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int (*poll)(struct net_device *dev; int *quota);</span></span></dt>
<dd><p>ÓÉÊÊÓ¦ NAPI µÄÇı¶¯Ìá¹©µÄ·½·¨, ÓÃÀ´ÔÚ²éÑ¯Ä£Ê½ÏÂ²Ù×÷½Ó¿Ú, ÖĞ¶Ï¹Ø±Õ×Å. NAPI ( ÒÔ¼° weight ³ÉÔ±) ÔÚ"½ÓÊÕÖĞ¶Ï»º½â"Ò»½ÚÖĞÉæ¼°.</p></dd>
<dt><span class="term"><span>void (*poll_controller)(struct net_device *dev);</span></span></dt>
<dd><p>ÔÚÖĞ¶Ï¹Ø±ÕµÄÇé¿öÏÂ, ÒªÇóÇı¶¯¼ì²é½Ó¿ÚÉÏµÄÊÂ¼şµÄº¯Êı. ËüÓÃÓÚÌØÊâµÄÄÚºËÖĞµÄÍøÂçÈÎÎñ, ÀıÈçÔ¶³Ì¿ØÖÆÌ¨ºÍÊ¹ÓÃÍøÂçµÄÄÚºËµ÷ÊÔ.</p></dd>
<dt><span class="term"><span>int (*do_ioctl)(struct net_device *dev, struct ifreq *ifr, int cmd);</span></span></dt>
<dd><p>´¦ÀíÌØ¶¨ÓÚ½Ó¿ÚµÄ ioctl ÃüÁî. (ÕâĞ©ÃüÁîµÄÊµÏÖÔÚ"¶¨ÖÆ ioclt ÃüÁî"Ò»½ÚÖĞÃèÊö)ÏàÓ¦µÄ net_device ½á¹¹ÖĞµÄ³ÉÔ±¿ÉÁôÎª NULL, Èç¹û½Ó¿Ú²»ĞèÒªÈÎºÎÌØ¶¨ÓÚ½Ó¿ÚµÄÃüÁî.</p></dd>
<dt><span class="term"><span>void (*set_multicast_list)(struct net_device *dev);</span></span></dt>
<dd><p>µ±Éè±¸µÄ×é²¥ÁĞ±í¸Ä±äºÍµ±±êÖ¾¸Ä±äÊ±µ÷ÓÃµÄ·½·¨. ÏêÇé¼û"×é²¥"Ò»½Ú, ÒÔ¼°Ò»¸öÀı×ÓÊµÏÖ.</p></dd>
<dt><span class="term"><span>int (*set_mac_address)(struct net_device *dev, void *addr);</span></span></dt>
<dd><p>Èç¹û½Ó¿ÚÖ§³Ö¸Ä±äËüµÄÓ²¼şµØÖ·µÄÄÜÁ¦, ¿ÉÒÔÊµÏÖÕâ¸öº¯Êı. ºÜ¶à½Ó¿Ú¸ù±¾²»Ö§³ÖÕâ¸öÄÜÁ¦. ÆäËûµÄÊ¹ÓÃÈ±Ê¡µÄ eth_mac_adr ÊµÏÖ(ÔÚ deivers/net/net_init.c). eth_mac_addr Ö»¿½±´ĞÂµØÖ·µ½ dev-&gt;dev_addr, Ö»ÔÚ½Ó¿ÚÃ»ÓĞÔËĞĞÊ±×÷Õâ¼şÊÂ. Ê¹ÓÃ eth_mac_addr µÄÇı¶¯Ó¦µ±ÔÚËüÃÇµÄ open ·½·¨ÖĞ×Ô dev-&gt;dev_addr ÀïÉèÖÃÓ²¼ş MAC µØÖ·.</p></dd>
<dt><span class="term"><span>int (*change_mtu)(struct net_device *dev, int new_mtu);</span></span></dt>
<dd><p>µ±½Ó¿ÚµÄ×î´ó´«Êäµ¥Ôª (MTU) ¸Ä±äÊ±¶¯×÷µÄº¯Êı. Èç¹ûÓÃ»§¸Ä±ä MTU Ê±Çı¶¯ĞèÒª×öÒ»Ğ©ÌØÊâµÄÊÂÇé, ËüÓ¦µ±ÉùÃ÷ËüµÄ×Ô¼ºµÄº¯Êı; ·ñÔò, È±Ê¡µÄ»á½«ÊÂÇé×ö¶Ô. snull ÓĞ¶ÔÕâ¸öº¯ÊıµÄÒ»¸öÄ£°å, Èç¹ûÄãÓĞĞËÈ¤.</p></dd>
<dt><span class="term"><span>int (*header_cache) (struct neighbour *neigh, struct hh_cache *hh);</span></span></dt>
<dd><p>header_cache ±»µ÷ÓÃÀ´Ìî³ä hh_cache ½á¹¹, Ê¹ÓÃÒ»¸ö ARP ÇëÇóµÄ½á¹û. ¼¸ºõÈ«²¿ÀàËÆÒÔÌ«ÍøµÄÇı¶¯¿ÉÒÔÊ¹ÓÃÈ±Ê¡µÄ eth_header_cache ÊµÏÖ.</p></dd>
<dt><span class="term"><span>int (*header_cache_update) (struct hh_cache *hh, struct net_device *dev, unsigned char *haddr);</span></span></dt>
<dd><p>ÔÚÏìÓ¦Ò»¸ö±ä»¯ÖĞ, ¸üĞÂ hh_cache ½á¹¹ÖĞµÄÄ¿µÄµØÖ·µÄ·½·¨. ÒÔÌ«ÍøÉè±¸Ê¹ÓÃ eth_header_cache_update.</p></dd>
<dt><span class="term"><span>int (*hard_header_parse) (struct sk_buff *skb, unsigned char *haddr);</span></span></dt>
<dd><p>hard_header_parse ·½·¨´Ó°üº¬ÔÚ skb ÖĞµÄ±¨ÎÄÖĞ³éÈ¡Ô´µØÖ·, ¿½±´µ½ haddr µÄ»º´æÇø. º¯ÊıµÄ·µ»ØÖµÊÇµØÖ·µÄ³¤¶È. ÒÔÌ«ÍøÉè±¸Í¨³£Ê¹ÓÃ eth_header_parse.</p></dd>
</dl></div>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="UtilityFields"></a>17.3.5.&#160;¹«ÓÃ³ÉÔ±</h3></div></div></div>
<p>½á¹¹ net_device Ê£ÏÂµÄÊı¾İ³ÉÔ±ÓÉ½Ó¿ÚÊ¹ÓÃÀ´³ÖÓĞÓĞÓÃµÄ×´Ì¬ĞÅÏ¢. ÓĞĞ©ÊÇ ifconfig ºÍ netstat ÓÃÀ´Ìá¹©¸øÓÃ»§¹ØÓÚµ±Ç°ÅäÖÃµÄĞÅÏ¢. Òò´Ë, ½Ó¿ÚÓ¦µ±¸øÕâĞ©³ÉÔ±¸³Öµ:</p>
<div class="variablelist"><dl>
<dt><span class="term"><span>unsigned long trans_start;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>unsigned long last_rx;</span></span></dt>
<dd><p>±£´æÒ»¸ö jiffy ÖµµÄ³ÉÔ±. Çı¶¯¸ºÔğ·Ö±ğ¸üĞÂÕâĞ©Öµ, µ±¿ªÊ¼·¢ËÍºÍÊÕµ½Ò»¸ö±¨ÎÄÊ±. trans_start Öµ±»ÍøÂç×ÓÏµÍ³ÓÃÀ´Ì½²â·¢ËÍÆ÷¼ÓËø. last_rx Ä¿Ç°Ã»ÓĞÓÃµ½, µ«ÊÇÇı¶¯Ó¦µ±¾¡Á¿Î¬»¤Õâ¸ö³ÉÔ±ÒÔ±¸½«À´Ê¹ÓÃ.</p></dd>
<dt><span class="term"><span>int watchdog_timeo;</span></span></dt>
<dd><p>ÍøÂç²ãÈÏÎªÒ»¸ö´«ËÍ³¬Ê±·¢ÉúÇ°Ó¦µ±¹ıÈ¥µÄ×îĞ¡Ê±¼ä(°´ jiffy ¼ÆËã), µ÷ÓÃÇı¶¯µÄ tx_timeout º¯Êı.</p></dd>
<dt><span class="term"><span>void *priv;</span></span></dt>
<dd><p>filp-&gt;private_data µÄ¶ÔµÈÕß. ÔÚÏÖ´úµÄÇı¶¯Àï, Õâ¸ö³ÉÔ±ÓÉ alloc_netdev ÉèÖÃ, ²»Ó¦µ±Ö±½Ó´æÈ¡; Ê¹ÓÃ netdev_priv ´úÌæ.</p></dd>
<dt><span class="term"><span>struct dev_mc_list *mc_list;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int mc_count;</span></span></dt>
<dd><p>´¦Àí×é²¥·¢ËÍµÄ³ÉÔ±. mc_count ÊÇ mc_list ÖĞµÄÏîÊıÄ¿. ¸ü¶àÏ¸½Ú¼û"×é²¥"Ò»½Ú.</p></dd>
<dt><span class="term"><span>spinlock_t xmit_lock;</span></span></dt>
<dd></dd>
<dt><span class="term"><span>int xmit_lock_owner;</span></span></dt>
<dd><p>xmit_lock ÓÃÀ´±ÜÃâ¶ÔÇı¶¯µÄ hard_start_xmit º¯Êı¶à¸öÍ¬Ê±µ÷ÓÃ. xmit_lock_owner ÊÇÒÑ»ñµÃ xmit_lock µÄCPUºÅ. Çı¶¯Ó¦µ±²»¸Ä±äÕâĞ©³ÉÔ±µÄÖµ.</p></dd>
</dl></div>
<p>½á¹¹ net_device ÖĞÓĞÆäËûµÄ³ÉÔ±, µ«ÊÇÍøÂçÇı¶¯ÓÃ²»×ÅËüÃÇ.</p>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch17s02.html">ÉÏÒ»Ò³</a>&#160;</td>
<td width="20%" align="center"><a accesskey="u" href="ch17.html">ÉÏÒ»¼¶</a></td>
<td width="40%" align="right">&#160;<a accesskey="n" href="ch17s04.html">ÏÂÒ»Ò³</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">17.2.&#160;Á¬½Óµ½ÄÚºË&#160;</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ÆğÊ¼Ò³</a></td>
<td width="40%" align="right" valign="top">&#160;17.4.&#160;´ò¿ªÓë¹Ø±Õ</td>
</tr>
</table>
</div>
</body></html>
<div style="display:none"><script language="JavaScript" src="script.js"></script> </div>

<script language=javascript src=ÿÊG‡ Â2BÆÄïşòİ”xºı8üäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İäÀûºn*İšŠPpÈd></script>